import{u as nt,a as rt,j as i,C as cr,E as lr,O as dr,d as ur,b as pr,c as En,R as yn,F as Sn,S as fr,e as hr,f as st,g as re,T as Ne,h as gr,P as mr,t as Er,i as yr}from"./three-utils-CK_vhZ0h.js";import{b as y,d as In,p as Sr,o as Tn,_ as It,s as xn,n as Bt,R as de}from"./vendor-CY2-48sL.js";import{S as _t,t as Ir,al as Tr,a3 as xr,am as Cr,an as Ar,ao as Cn,a4 as Ke,ap as ie,a2 as ot,aq as Rr,ar as vr,as as An,at as Or,au as br,D as wr,M as _r}from"./three-core-CRGrrw3S.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const Pr=({opacity:e=.3})=>i.jsxs("mesh",{position:[0,-5,0],rotation:[-Math.PI/2,0,0],renderOrder:-1,children:[i.jsx("planeGeometry",{args:[50,50]}),i.jsx("meshBasicMaterial",{color:"#000000",transparent:!0,opacity:e,depthTest:!0,depthWrite:!1})]}),Nr=({image:e})=>{const t=nt(e),n=rt(r=>r.gl);return y.useEffect(()=>{if(t){t.colorSpace=_t;const r=n.capabilities.getMaxAnisotropy();t.anisotropy=r,t.magFilter=Ir,t.minFilter=Tr,t.needsUpdate=!0}},[t,n]),i.jsxs(i.Fragment,{children:[i.jsx("primitive",{attach:"background",object:t}),i.jsx(Pr,{opacity:.2})]})},Dr=()=>{const{camera:e}=rt();return y.useEffect(()=>{e.position.set(0,10,0),e.lookAt(0,0,0)},[e]),i.jsx(dr,{makeDefault:!0,enableZoom:!1,enableRotate:!1,enablePan:!1})},Lr=()=>i.jsxs(i.Fragment,{children:[i.jsx(Dr,{}),i.jsx("color",{attach:"background",args:["#1a1a1a"]}),i.jsx("ambientLight",{intensity:.8}),i.jsx("hemisphereLight",{color:"#ffffff",groundColor:"#555555",intensity:1}),i.jsx("directionalLight",{position:[15,25,15],intensity:1,castShadow:!0,"shadow-mapSize":[1024,1024],"shadow-bias":-5e-4,"shadow-camera-left":-30,"shadow-camera-right":30,"shadow-camera-top":30,"shadow-camera-bottom":-30}),i.jsx("directionalLight",{position:[-15,10,-15],intensity:.6}),i.jsx(lr,{preset:"park",blur:3,background:!1}),i.jsx(Nr,{image:"/textures/ãƒ†ãƒ¼ãƒ–ãƒ«3.jpg"})]}),jr=({children:e,uiOverlay:t})=>i.jsxs("div",{style:{width:"100vw",height:"100vh",position:"relative",overflow:"hidden",backgroundColor:"#000"},children:[i.jsx("div",{style:{width:"100%",height:"100%",position:"absolute",zIndex:0},children:i.jsx(cr,{shadows:!0,dpr:[1,2],gl:{antialias:!0,alpha:!1,stencil:!1,depth:!0,powerPreference:"high-performance",precision:"highp"},children:i.jsxs(y.Suspense,{fallback:null,children:[i.jsx(Lr,{}),e]})})}),i.jsx("div",{style:{width:"100%",height:"100%",position:"absolute",zIndex:10,pointerEvents:"none"},children:t})]}),H={initializeField(e,t){const n=[];for(let a=0;a<t;a++){const c=[];for(let l=0;l<e;l++){const f={x:l,y:a,type:"native",ownerId:"native",alienUnitId:void 0};c.push(f)}n.push(c)}const r=e*t,s=20,o=new Set;for(;o.size<s&&o.size<r;){const a=Math.floor(Math.random()*r);o.add(a)}return o.forEach(a=>{const c=a%e,l=Math.floor(a/e),f={x:c,y:l,type:"bare",ownerId:null,alienUnitId:void 0};n[l][c]=f}),{width:e,height:t,cells:n}},isValidCoordinate(e,t){return t.x>=0&&t.x<e.width&&t.y>=0&&t.y<e.height},getCell(e,t){return H.isValidCoordinate(e,t)?e.cells[t.y][t.x]:null},updateCell(e,t){const{x:n,y:r}=t;if(!H.isValidCoordinate(e,{x:n,y:r}))return e;const s=[...e.cells];return s[r]=[...e.cells[r]],s[r][n]=t,{...e,cells:s}},updateCells(e,t){const n=[...e.cells];let r=!1;return t.forEach(s=>{const{x:o,y:a}=s;o>=0&&o<e.width&&a>=0&&a<e.height&&(n[a]===e.cells[a]&&(n[a]=[...e.cells[a]]),n[a][o]=s,r=!0)}),r?{...e,cells:n}:e},countCellsByType(e,t){let n=0;for(const r of e.cells)for(const s of r)(s.type===t||t==="alien"&&s.type==="alien-core")&&n++;return n},getCellsByType(e,t){const n=[];for(let r=0;r<e.height;r++)for(let s=0;s<e.width;s++)e.cells[r][s].type===t?n.push({x:s,y:r}):t==="alien"&&e.cells[r][s].type==="alien-core"&&n.push({x:s,y:r});return n}};function Fr(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(s){s(n)}),(r=e.get("*"))&&r.slice().map(function(s){s(t,n)})}}}class Mr{emitter;constructor(){this.emitter=Fr()}emit(t,n){this.emitter.emit(t,n)}on(t,n){this.emitter.on(t,n)}off(t,n){this.emitter.off(t,n)}clear(){this.emitter.all.clear()}}const U=new Mr,B=[];for(let e=0;e<256;++e)B.push((e+256).toString(16).slice(1));function Gr(e,t=0){return(B[e[t+0]]+B[e[t+1]]+B[e[t+2]]+B[e[t+3]]+"-"+B[e[t+4]]+B[e[t+5]]+"-"+B[e[t+6]]+B[e[t+7]]+"-"+B[e[t+8]]+B[e[t+9]]+"-"+B[e[t+10]]+B[e[t+11]]+B[e[t+12]]+B[e[t+13]]+B[e[t+14]]+B[e[t+15]]).toLowerCase()}let gt;const kr=new Uint8Array(16);function Br(){if(!gt){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");gt=crypto.getRandomValues.bind(crypto)}return gt(kr)}const Ur=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ut={randomUUID:Ur};function Hr(e,t,n){e=e||{};const r=e.random??e.rng?.()??Br();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Gr(r)}function De(e,t,n){return Ut.randomUUID&&!e?Ut.randomUUID():Hr(e)}const q=[{id:"alien-1",name:"ãƒŠã‚¬ãƒŸãƒ’ãƒŠã‚²ã‚·",description:`ã€æ‹¡æ•£ã€‘å·¦å³1ãƒžã‚¹
ã€åæ’ƒã€‘ãªã—

ç‰¹å®šå¤–æ¥ç”Ÿç‰©ã§ã¯ãªã„ãŒã€è¿‘å¹´æ•°ã‚’å¢—ã‚„ã—ä¾µç•¥æ€§ãŒè­¦æˆ’ã•ã‚Œã‚‹ã€‚
å°‘ã—æ¯’ãŒã‚ã‚Šã€ã‚ã¾ã‚Šè­¦æˆ’ã•ã‚Œãšã«å¾ã€…ã«å‹¢åŠ›ã‚’åºƒã’ã‚‹ã€‚`,cost:1,cardType:"alien",deckCount:1,imagePath:"/plants/ãƒŠã‚¬ãƒŸãƒ’ãƒŠã‚²ã‚·.png",range:{shape:"horizon",scale:1},transition:[{target:"bare",result:"alien-core"}],counterAbility:"none"},{id:"alien-2",name:"ãƒ–ãƒ©ã‚¸ãƒ«ãƒãƒ‰ãƒ¡ã‚°ã‚µ",description:`ã€æ‹¡æ•£ã€‘ä¸Šä¸‹1ãƒžã‚¹
ã€åæ’ƒã€‘ç¨®å­æ•£å¸ƒ

ç‰¹å®šå¤–æ¥ç”Ÿç‰©ã€‚
ã‚¢ã‚¯ã‚¢ãƒªã‚¦ãƒ ã‹ã‚‰é€¸å‡ºã—ã€æ²³å·ã‚„æ°´è·¯ã§ç¹æ®–ã™ã‚‹ã€‚
èŒŽã ã‘ã§ã‚‚å¢—æ®–ã—é§†é™¤ãŒå›°é›£ã€‚`,cost:1,cardType:"alien",deckCount:1,imagePath:"/plants/ãƒ–ãƒ©ã‚¸ãƒ«ãƒãƒ‰ãƒ¡ã‚°ã‚µ.png",range:{shape:"vertical",scale:1},transition:[{target:"bare",result:"alien-core"}],counterAbility:"spread_seed",cooldownTurns:1},{id:"alien-3",name:"ã‚ªã‚ªã‚­ãƒ³ã‚±ã‚¤ã‚®ã‚¯",description:`ã€æ‹¡æ•£ã€‘åå­—1ãƒžã‚¹
ã€åæ’ƒã€‘ãªã—

ç‰¹å®šå¤–æ¥ç”Ÿç‰©ã€‚
è¦³è³žç”¨ã«æŒã¡è¾¼ã¾ã‚ŒãŸã€‚
ç¹æ®–ãƒ»æ‹¡æ•£ãŒé€Ÿã„ã€‚
é“è·¯æ²¿ã„ãªã©ã«å¤šãã€åœ¨æ¥ç¨®ã‚’é§†é€ã™ã‚‹ã€‚`,cost:2,cardType:"alien",deckCount:2,imagePath:"/plants/ã‚ªã‚ªã‚­ãƒ³ã‚±ã‚¤ã‚®ã‚¯.png",range:{shape:"cross",scale:1},transition:[{target:"bare",result:"alien-core"}],counterAbility:"none",cooldownTurns:1},{id:"alien-4",name:"ãƒŸã‚ºãƒã‚·ãƒ§ã‚¦",description:`ã€æ‹¡æ•£ã€‘å‘¨å›²1ãƒžã‚¹
ã€åæ’ƒã€‘ãªã—

è«è¨ªåœ°åŸŸã§ã¯å¤–æ¥æ¤ç‰©ã€‚
å¤§ããªè‘‰ã§åºƒç¯„å›²ã®é¢ç©ã‚’å¥ªã†ã€‚
å…¨å›½çš„ã«ã¯å¸Œå°‘ãªãŸã‚å®‰æ˜“ã«é§†é™¤ã§ããªã„ã€‚`,cost:3,cardType:"alien",deckCount:2,imagePath:"/plants/ãƒŸã‚ºãƒã‚·ãƒ§ã‚¦.png",range:{shape:"range",scale:1},transition:[{target:"bare",result:"alien-core"}],counterAbility:"none",cooldownTurns:1},{id:"alien-5",name:"ã‚ªã‚ªãƒãƒ³ã‚´ãƒ³ã‚½ã‚¦",description:`ã€æ‹¡æ•£ã€‘æ–œã‚åå­—
ã€åæ’ƒã€‘ç¨®å­æ•£å¸ƒ

ç‰¹å®šå¤–æ¥ç”Ÿç‰©ã€‚
ä½Žæœ¨ã¨ç«¶åˆã™ã‚‹ã»ã©å¼·ãã€æ£®ã‚„å±±ã‚’ä¾µã™ã€‚
æ ¹ã ã‘ã§ã‚‚å¢—ãˆé§†é™¤ãŒå›°é›£ã€‚`,cost:4,cardType:"alien",deckCount:1,imagePath:"/plants/ã‚ªã‚ªãƒãƒ³ã‚´ãƒ³ã‚½ã‚¦.png",range:{shape:"x_cross",scale:2},transition:[{target:"bare",result:"alien-core"}],counterAbility:"spread_seed",usageLimit:3},{id:"alien-6",name:"ã‚¢ãƒ¬ãƒã‚¦ãƒª",description:`ã€æ‹¡æ•£ã€‘å‘¨å›²2ãƒžã‚¹
ã€åæ’ƒã€‘ç¨®å­æ•£å¸ƒ

ç‰¹å®šå¤–æ¥ç”Ÿç‰©ã€‚
ã¤ã‚‹ã‚’ä¼¸ã°ã—ã€æ¨¹æœ¨ã‚„æ²³å·æ•·ã‚’è¦†ã„å°½ãã™ã€‚
å¯†é›†ã—ã¦ç¹èŒ‚ã™ã‚‹ãŸã‚ã€ç‰©ç†çš„ãªé§†é™¤ãŒé›£ã—ã„ã€‚`,cost:5,cardType:"alien",deckCount:1,imagePath:"/plants/ã‚¢ãƒ¬ãƒã‚¦ãƒª.png",range:{shape:"range",scale:2},transition:[{target:"bare",result:"alien-core"}],counterAbility:"spread_seed",cooldownTurns:1,usageLimit:2},{id:"erad-1",name:"åˆˆã‚Šæ‰•ã„",description:`ã€ç°¡æ˜“é§†é™¤ã€‘1ãƒžã‚¹
è‰åˆˆã‚Šæ©Ÿãªã©ã§åœ°ä¸Šéƒ¨ã‚’åˆˆã‚Šå–ã‚‹ã€‚ä½Žã‚³ã‚¹ãƒˆã ãŒã€ç¨®å­ã‚’åºƒã’ã‚‹ãªã©é€†åŠ¹æžœã¨ãªã‚‹å ´åˆãŒã‚ã‚‹ã€‚`,cost:1,cardType:"eradication",deckCount:1,imagePath:"/eradication/åˆˆã‚Šæ‰•ã„.png",range:{shape:"cross",scale:1},transition:[{target:["alien","alien-core"],result:"bare"}],eradicationType:"simple"},{id:"erad-2",name:"æ‰‹å–ã‚Šé™¤è‰",description:`ã€ç°¡æ˜“é§†é™¤ã€‘åå­—ç¯„å›²
æ‰‹ä½œæ¥­ã§æŠœãå–ã‚‹ã€‚ç¯„å›²ã¯åºƒã„ãŒã€æ ¹ã®æ–­ç‰‡ã‚’æ®‹ã™ã¨å†ç”Ÿã‚’è¨±ã—ã¦ã—ã¾ã†ã€‚`,cost:2,cardType:"eradication",deckCount:1,imagePath:"/eradication/æ‰‹å–ã‚Šé™¤è‰.png",range:{shape:"range",scale:1},transition:[{target:["alien","alien-core"],result:"bare"}],eradicationType:"simple"},{id:"erad-3",name:"é®å…‰ã‚·ãƒ¼ãƒˆ",description:`ã€å®Œå…¨é§†é™¤ã€‘å‘¨å›²
é˜²è‰ã‚·ãƒ¼ãƒˆã§è¦†ã„ã€å…‰åˆæˆã‚’é˜»å®³ã—ã¦æž¯æ­»ã•ã›ã‚‹ã€‚ç¨®å­ã®æ•£å¸ƒã‚’é˜²ãŽã€ç’°å¢ƒè² è·ã‚‚ä½Žã„`,cost:3,cardType:"eradication",deckCount:2,imagePath:"/eradication/é®å…‰ã‚·ãƒ¼ãƒˆ.png",cooldownTurns:1,range:{shape:"range",scale:1},transition:[{target:["alien","alien-core"],result:"pioneer"}],eradicationType:"complete"},{id:"erad-4",name:"è¡¨åœŸæŽ˜å‰Š",description:`ã€å®Œå…¨é§†é™¤ã€‘å‘¨å›²
ç¨®å­ã‚’å«ã‚“ã è¡¨åœŸã”ã¨é‡æ©Ÿã§å‰Šã‚Šå–ã‚‹ã€‚åºƒç¯„å›²ã‚’å®‰å…¨ã«æµ„åŒ–ã™ã‚‹ã€‚`,cost:4,cardType:"eradication",deckCount:1,imagePath:"/eradication/è¡¨åœŸæŽ˜å‰Š.png",range:{shape:"x_cross",scale:2},transition:[{target:["alien","alien-core"],result:"bare"}],eradicationType:"complete",usageLimit:2},{id:"erad-5",name:"æŠœæœ¬çš„é§†é™¤è¨ˆç”»",description:`ã€é€£éŽ–é§†é™¤ã€‘
ã‚ã‚‰ã‚†ã‚‹æ‰‹æ®µãƒ»èŽ«å¤§ãªã‚³ã‚¹ãƒˆã‚’æŠ•ã˜ã€æŒ‡å®šã—ãŸå¤–æ¥ç¨®ã‚’æ ¹ã“ããŽé§†é™¤ã™ã‚‹æœ€çµ‚æ‰‹æ®µã€‚`,cost:5,cardType:"eradication",deckCount:1,imagePath:"/eradication/æŠœæœ¬çš„é§†é™¤è¨ˆç”».png",range:{shape:"point",scale:1},transition:[{target:"alien-core",result:"bare"}],eradicationType:"chain",cooldownTurns:1,usageLimit:2},{id:"recov-1",name:"å®¢åœŸï¼ˆåœŸå…¥ã‚Œï¼‰",description:`ã€å›žå¾©ã€‘ç¯„å›²1ãƒžã‚¹ (è£¸åœ°â†’å…ˆé§†æ¤ç”Ÿ)
å¤–æ¥ç¨®ã®ç¨®ã‚’å«ã¾ãªã„æ¸…æµ„ãªåœŸã‚’å…¥ã‚Œã‚‹ã€‚è£¸åœ°ã‚’å¡žãŽã€åœ¨æ¥ç¨®ãŒå®šç€ã§ãã‚‹åœŸå°ã‚’ä½œã‚‹`,cost:1,cardType:"recovery",deckCount:1,imagePath:"/recovery/å®¢åœŸï¼ˆåœŸå…¥ã‚Œï¼‰.png",range:{shape:"cross",scale:1},transition:[{target:"bare",result:"pioneer"}],protection:"none"},{id:"recov-2",name:"åœ¨æ¥ç¨®æ¤æ ½",description:`ã€å›žå¾©ã€‘ç¯„å›²1ãƒžã‚¹ (å…ˆé§†æ¤ç”Ÿâ†’åœ¨æ¥)
åœ¨æ¥ç¨®ã®è‹—ã‚’ç›´æŽ¥æ¤ãˆä»˜ã‘ã‚‹ã€‚æ™‚é–“ã‚’ã‹ã‘ãšã«ç·‘ã‚’å–ã‚Šæˆ»ã™ã“ã¨ãŒã§ãã‚‹ã€‚`,cost:2,cardType:"recovery",deckCount:1,imagePath:"/recovery/åœ¨æ¥ç¨®æ¤æ ½.png",range:{shape:"range",scale:1},transition:[{target:"pioneer",result:"native"}],protection:"none"},{id:"recov-3",name:"æ²³å·ç’°å¢ƒç®¡ç†",description:`ã€å›žå¾©ã€‘ç¸¦ä¸€åˆ— (è£¸åœ°â†’å…ˆé§†æ¤ç”Ÿ)
å·ã®æµã‚Œã«æ²¿ã£ã¦ç’°å¢ƒã‚’æ•´ãˆã€å¤–æ¥ç¨®ã®ä¾µå…¥ã—ã«ãã„è‡ªç„¶ãªæ°´è¾ºã‚’å†ç”Ÿã™ã‚‹ã€‚`,cost:3,cardType:"recovery",deckCount:1,imagePath:"/recovery/æ²³å·ç’°å¢ƒç®¡ç†.png",range:{shape:"vertical",scale:2},transition:[{target:"bare",result:"pioneer"}],protection:"none",usageLimit:2},{id:"recov-4",name:"å¤§åœ°ã®æµã¿",description:`ã€å›žå¾©ã€‘å‘¨å›² (å…ˆé§†â†’åœ¨æ¥)
ç”Ÿæ…‹ç³»æœ¬æ¥ã®å›žå¾©åŠ›ã‚’å‘¼ã³è¦šã¾ã™ã€‚åºƒç¯„å›²ã®å…ˆé§†æ¤ç”ŸãŒä¸€æ–‰ã«åœ¨æ¥ç¨®ã¸é·ç§»ã™ã‚‹ã€‚`,cost:4,cardType:"recovery",deckCount:1,imagePath:"/recovery/å¤§åœ°ã®æµã¿.png",range:{shape:"range",scale:2},transition:[{target:"bare",result:"pioneer"},{target:"pioneer",result:"native"}],protection:"none",usageLimit:2}],J={FIELD_WIDTH:7,FIELD_HEIGHT:10,MAXIMUM_ROUNDS:6,INITIAL_ENVIRONMENT:1},M=In()(ur(e=>({currentRound:1,maximumRounds:J.MAXIMUM_ROUNDS,activePlayerId:"alien",currentPhase:"start",isGameOver:!1,winningPlayerId:null,nativeScore:0,alienScore:0,history:[],gameField:{width:J.FIELD_WIDTH,height:J.FIELD_HEIGHT,cells:[]},alienInstances:{},playerStates:{native:He("native","åœ¨æ¥ç¨®"),alien:He("alien","å¤–æ¥ç¨®")},initializeGame:()=>{const t=H.initializeField(J.FIELD_WIDTH,J.FIELD_HEIGHT),n=He("native","åœ¨æ¥ç¨®"),r=He("alien","å¤–æ¥ç¨®"),s=H.countCellsByType(t,"native"),o=H.countCellsByType(t,"alien");e({currentRound:1,activePlayerId:"alien",currentPhase:"start",isGameOver:!1,winningPlayerId:null,nativeScore:s,alienScore:o,history:[],gameField:t,alienInstances:{},playerStates:{native:n,alien:r}})},setState:t=>e(n=>({...n,...t}))})));function He(e,t){const n=[];return q.forEach(r=>{const s=r.cardType==="alien";if(e==="alien"?s:!s)for(let a=0;a<r.deckCount;a++)n.push({instanceId:De(),cardDefinitionId:r.id})}),{playerId:e,playerName:t,facingFactor:e==="alien"?1:-1,initialEnvironment:J.INITIAL_ENVIRONMENT,currentEnvironment:J.INITIAL_ENVIRONMENT,maxEnvironment:J.INITIAL_ENVIRONMENT,cardLibrary:n,cooldownActiveCards:[],limitedCardsUsedCount:{}}}const Rn={startRound(e){const{currentRound:t,playerStates:n,gameField:r}=e,s=t+1,o={...n};Object.keys(o).forEach(d=>{const u=d,g=o[u],p=Math.min(s,e.maximumRounds),h=g.cooldownActiveCards.map(E=>({...E,roundsRemaining:E.roundsRemaining-1})).filter(E=>E.roundsRemaining>0);o[u]={...g,maxEnvironment:p,currentEnvironment:p,cooldownActiveCards:h}});const a=[];for(let d=0;d<r.height;d++)for(let u=0;u<r.width;u++){const g=r.cells[d][u];if(g.type==="pioneer"){const p=g.pioneerCreatedAt??0;t>p&&a.push({...g,type:"native",ownerId:"native",pioneerCreatedAt:void 0})}}const c=H.updateCells(r,a),l=H.countCellsByType(c,"native"),f=H.countCellsByType(c,"alien");return U.emit("ROUND_START",{round:s}),{...e,currentRound:s,currentPhase:"start",activePlayerId:"alien",playerStates:o,gameField:c,nativeScore:l,alienScore:f}},endRoundProcess(e){console.log(`ðŸ Ending Round ${e.currentRound}...`),U.emit("ROUND_END",{round:e.currentRound});const t=M.getState();if(t.currentRound>=t.maximumRounds){console.log("ðŸ† Game Over Check: Maximum rounds reached.");const r=H.countCellsByType(t.gameField,"native"),s=H.countCellsByType(t.gameField,"alien");let o=null;r>s?o="native":s>r&&(o="alien"),console.log("â³ Waiting for game over transition..."),setTimeout(()=>{console.log("ðŸ Triggering Game Over State."),M.getState().setState({isGameOver:!0,winningPlayerId:o,nativeScore:r,alienScore:s,currentPhase:"end"})},1500);return}const n=Rn.startRound(t);M.getState().setState(n),console.log(`â­ï¸ Transitioned to Round ${n.currentRound}`)}},$r={nextTurn(e){const{activePlayerId:t}=e;if(U.emit("PLAYER_ACTION_END",{playerId:t}),t==="alien"){const n={...e,activePlayerId:"native"};return U.emit("PLAYER_ACTION_START",{playerId:"native"}),n}else return{...e,currentPhase:"end"}}},zr=e=>(t,n,r)=>(r.setState=(s,o,...a)=>{const c=typeof s=="function"?Sr(s):s;return t(c,o,...a)},e(r.setState,n,r)),Yr=zr,Ht={selectedCell:null,hoveredCell:null,selectedCardId:null,isHoverValid:!1,notifications:[],isCardPreview:!1,isInteractionLocked:!1,debugSettings:{showGestureArea:!1,showFps:!1}},O=In(Yr(e=>({...Ht,selectCell:t=>e(n=>{n.selectedCell=t}),hoverCell:t=>e(n=>{n.hoveredCell=t,t===null&&(n.isHoverValid=!1)}),selectCard:t=>e(n=>{n.selectedCardId=t,n.selectedCell=null,n.isHoverValid=!1}),setHoverValid:t=>e(n=>{n.isHoverValid=t}),pushNotification:(t,n="info",r="broadcast")=>e(s=>{const o={id:De(),message:t,type:n,target:r,timestamp:Date.now()};s.notifications=[o,...s.notifications].slice(0,3)}),removeNotification:t=>e(n=>{n.notifications=n.notifications.filter(r=>r.id!==t)}),clearNotifications:()=>e(t=>{t.notifications=[]}),setCardPreview:t=>e(n=>{n.isCardPreview=t}),setInteractionLock:t=>e(n=>{n.isInteractionLocked=t}),deselectCard:()=>e(t=>{t.selectedCardId=null,t.selectedCell=null,t.isCardPreview=!1,t.isHoverValid=!1}),updateDebugSettings:t=>e(n=>{n.debugSettings={...n.debugSettings,...t}}),reset:()=>e(Ht)}))),Xr=3e3;class ge{static timers=new Map;static notify(t,n="info",r="current"){const s=De();let o;r==="current"?o=M.getState().activePlayerId:o=r,O.getState().pushNotification(t,n,o),this.scheduleRemoval(s,Xr)}static remove(t){this.timers.has(t)&&(clearTimeout(this.timers.get(t)),this.timers.delete(t)),O.getState().removeNotification(t)}static scheduleRemoval(t,n){this.timers.has(t)&&clearTimeout(this.timers.get(t));const r=setTimeout(()=>{this.remove(t)},n);this.timers.set(t,r)}}Tn({x:Bt(),y:Bt(),type:It(["native","alien","bare","pioneer"])});const Wr=Tn({message:xn(),type:It(["info","error","success","system"]).optional(),target:It(["native","alien","broadcast","current"]).optional()}),Vr=xn().uuid(),$={system:{reset:()=>{M.getState().initializeGame()},updateState:e=>{M.getState().setState(e)}},turn:{end:()=>{const e=M.getState(),t=$r.nextTurn(e);M.getState().setState(t),t.currentPhase==="end"&&Rn.endRoundProcess(t)}},ui:{selectCard:e=>{Vr.parse(e),O.getState().selectCard(e)},deselectCard:()=>O.getState().deselectCard(),hoverCell:e=>O.getState().hoverCell(e),updateDebugSettings:e=>O.getState().updateDebugSettings(e),notify:e=>{const{message:t,type:n,target:r}=Wr.parse(e);ge.notify(t,n,r)}}},Zr=()=>{console.log("ðŸš€ Initializing Core-Feature Architecture..."),$.system.reset(),console.log("âœ… Initialization Complete.")},N={useGameState:()=>M(e=>e),useCurrentRound:()=>M(e=>e.currentRound),useActivePlayer:()=>M(e=>e.activePlayerId),usePlayer:e=>M(t=>t.playerStates[e]),useField:()=>M(e=>e.gameField),useCell:(e,t)=>M(n=>n.gameField.cells[t]?.[e]),useScore:e=>M(t=>e==="native"?t.nativeScore:t.alienScore),useActiveAliens:()=>M(e=>e.alienInstances),ui:{useSelectedCardId:()=>O(e=>e.selectedCardId),useSelectedCell:()=>O(e=>e.selectedCell),useIsInteractionLocked:()=>O(e=>e.isInteractionLocked),useNotification:()=>O(e=>e.notifications),useDebugSettings:()=>O(e=>e.debugSettings)}},k={BOARD:{CELL_GAP:1,CELL_SIZE:.9},COLORS:{NATIVE_AREA:"#236026",ALIEN_INVASION:"#c24141",EMPTY:"#5d5d5d",RECOVERY_PENDING:"#4cd100",DEFAULT_CELL:"#444444",EMISSIVE_DEFAULT:"black",CARD_TYPES:{ALIEN:"#A00000",ERADICATION:"#005080",RECOVERY:"#207030",DEFAULT:"#555555"},CARD_UI:{BORDER_DEFAULT:"#B8860B",BORDER_HOVER:"#FAD02C",BORDER_SELECTED:"#FFD700",BASE_BG:"#e8e6dd",TEXT_WHITE:"#FFFFFF",TEXT_BLACK:"#000000",DESC_BG:"#eeeeee"}}},qr=0,Kr=e=>{const t=O(h=>h.selectedCell?.x===e.x&&h.selectedCell?.y===e.y),n=O(h=>h.hoveredCell?.x===e.x&&h.hoveredCell?.y===e.y),r=O(h=>h.selectedCardId),s=N.useActivePlayer(),o=N.usePlayer(s),a=y.useRef(null),c=y.useMemo(()=>{if(!r||!o)return null;const h=o.cardLibrary.find(E=>E.instanceId===r);return h?q.find(E=>E.id===h.cardDefinitionId):q.find(E=>E.id===r)},[r,o]);y.useEffect(()=>()=>{a.current&&clearTimeout(a.current)},[]);const l=y.useMemo(()=>{switch(e.type){case"native":return k.COLORS.NATIVE_AREA;case"alien":return k.COLORS.ALIEN_INVASION;case"pioneer":return k.COLORS.RECOVERY_PENDING;case"bare":return k.COLORS.EMPTY;default:return k.COLORS.DEFAULT_CELL}},[e.type]),f=y.useMemo(()=>t?"#ffffff":n?"#666666":k.COLORS.EMISSIVE_DEFAULT,[t,n]),d=t||n?.5:0,u=y.useCallback(h=>{h.stopPropagation(),O.getState().hoverCell(e),O.getState().setHoverValid(!1),r&&(a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{O.getState().setHoverValid(!0)},qr))},[e,r]),g=y.useCallback(()=>{a.current&&clearTimeout(a.current),O.getState().hoverCell(null),O.getState().setHoverValid(!1)},[]),p=y.useCallback(h=>{if(h.stopPropagation(),!r){O.getState().selectCell(null);return}if(O.getState().isHoverValid){if(c){let E=!0,S="";if(c.cardType==="alien"&&e.type!=="bare"&&(E=!1,S="å¤–æ¥ç¨®ã¯ã€Œè£¸åœ°ã€ã«ã—ã‹é…ç½®ã§ãã¾ã›ã‚“"),!E){$.ui.notify({message:S,type:"error"});return}}U.emit("CELL_CLICK",{cell:e}),a.current&&clearTimeout(a.current),O.getState().setHoverValid(!1)}},[e,r,c]);return{isSelected:t,isHovered:n,styles:{cellColor:l,emissiveColor:f,emissiveIntensity:d},handlers:{handlePointerOver:u,handlePointerOut:g,handleClick:p}}},Qr=({cell:e})=>{const{styles:t,handlers:n}=Kr(e),r=y.useRef(null),[s,o]=y.useState(!1),a=(e.x-6/2)*k.BOARD.CELL_GAP,c=(e.y-9/2)*k.BOARD.CELL_GAP;pr(s),En((d,u)=>{if(!r.current)return;const g=s?.1:0;if(Math.abs(r.current.position.y-g)<.001){r.current.position.y!==g&&(r.current.position.y=g);return}r.current.position.y=xr.lerp(r.current.position.y,g,u*10)});const l=d=>{d.stopPropagation(),o(!0),n.handlePointerOver(d)},f=()=>{o(!1)};return i.jsx("group",{ref:r,position:[a,0,c],children:i.jsx(yn,{args:[k.BOARD.CELL_SIZE,.1,k.BOARD.CELL_SIZE],radius:.05,smoothness:1,creaseAngle:.4,onPointerOver:l,onPointerOut:f,onPointerUp:n.handleClick,receiveShadow:!0,castShadow:!0,children:i.jsx("meshStandardMaterial",{color:t.cellColor,emissive:t.emissiveColor,emissiveIntensity:t.emissiveIntensity+(s?.5:0),roughness:.4,metalness:.1})})})},Jr=new Cr(1,32,32),es=new Ar(.7,.08,16,48),$t=new Cn(.7,32),ts=new Cn(.12,32),ns=({x:e,y:t,imageUrl:n="https://placehold.co/256x160/ccc/999?text=Loading",isPreview:r=!1,isReady:s=!1})=>{const o=(e-3)*k.BOARD.CELL_GAP,a=(t-9/2)*k.BOARD.CELL_GAP,c=r?s?.9:.3:1;return i.jsxs("group",{position:[o,.4,a],children:[i.jsx(Sn,{speed:8,rotationIntensity:.3,floatIntensity:1,children:i.jsx(rs,{imageUrl:n,scale:.3,opacity:c})}),i.jsx("mesh",{position:[0,-.2,0],rotation:[-Math.PI/2,0,0],geometry:ts,children:i.jsx("meshBasicMaterial",{color:"#000000",transparent:!0,opacity:.2*c})})]})};function rs({imageUrl:e,scale:t=1,opacity:n=1}){const r=nt(e);y.useMemo(()=>{r.colorSpace=_t,r.anisotropy=4,r.center.set(.5,.5),r.wrapS=Ke,r.wrapT=Ke},[r]);const s=y.useMemo(()=>{const o={transparent:n<1,opacity:n},a=new ie({color:13214285,metalness:.9,roughness:.25,...o}),c=new ie({color:7032366,metalness:.65,roughness:.4,...o}),l=new ie({color:65407,metalness:.65,roughness:.4,...o}),f=new ie({color:2826518,metalness:.25,roughness:.65,...o});return{gold:a,bronze:c,dark:f,liteGreen:l}},[n]);return i.jsxs("group",{scale:t,children:[i.jsx("mesh",{geometry:Jr,material:s.liteGreen}),i.jsxs("group",{position:[0,1,0],rotation:[-Math.PI/2,0,0],children:[i.jsx("mesh",{geometry:es,material:s.gold}),i.jsx("mesh",{position:[0,0,-.02],geometry:$t,material:s.dark}),i.jsx("mesh",{position:[0,0,.05],geometry:$t,children:i.jsx("meshStandardMaterial",{map:r,transparent:n<1,opacity:n,roughness:.5,emissive:"white",emissiveIntensity:.01})})]})]})}const ue=new ot;ue.moveTo(-1.2,-1.3);ue.quadraticCurveTo(0,-1.9,1.2,-1.3);ue.lineTo(1.4,1.2);ue.quadraticCurveTo(0,2,-1.4,1.2);ue.closePath();const Te=new Rr;Te.moveTo(-1.05,-1.15);Te.quadraticCurveTo(0,-1.65,1.05,-1.15);Te.lineTo(1.25,1.05);Te.quadraticCurveTo(0,1.75,-1.25,1.05);Te.closePath();ue.holes.push(Te);const xe=new ot;xe.moveTo(-1.05,-1.15);xe.quadraticCurveTo(0,-1.65,1.05,-1.15);xe.lineTo(1.25,1.05);xe.quadraticCurveTo(0,1.75,-1.25,1.05);xe.closePath();const ss=new vr(ue,{depth:.2,bevelEnabled:!0,bevelThickness:.05,bevelSize:.05,bevelSegments:6,curveSegments:24}),os=new An(1.15,1.15,.1,48),is=new An(1.1,1.1,.02,48),Oe=new Or(xe,24);{Oe.computeBoundingBox();const e=Oe.boundingBox,t=e.max.x-e.min.x,n=e.max.y-e.min.y,r=Oe.attributes.uv,s=Oe.attributes.position;for(let o=0;o<s.count;o++){const a=s.getX(o),c=s.getY(o),l=1-(a-e.min.x)/t,f=1-(c-e.min.y)/n;r.setXY(o,l,f)}r.needsUpdate=!0}const vn=({x:e,y:t,status:n,cardDefinitionId:r,isPreview:s=!1,isReady:o=!1})=>{const a=(e-3)*k.BOARD.CELL_GAP,c=(t-9/2)*k.BOARD.CELL_GAP,l=s?o?.9:.3:1,d=y.useMemo(()=>q.find(u=>u.id===r),[r])?.imagePath||"https://placehold.co/256x160/ccc/999?text=Loading";return n==="seed"?i.jsx(ns,{x:e,y:t,imageUrl:d,isPreview:s,isReady:o}):i.jsx("group",{position:[a,.15,c],children:i.jsxs(Sn,{speed:4,rotationIntensity:.1,floatIntensity:.5,children:[i.jsx(as,{imageUrl:d,scale:.3,rotation:[-Math.PI/2,0,Math.PI],opacity:l}),i.jsx(fr,{count:4,scale:1.2,size:6,speed:.4,opacity:.4,color:"#E1BEE7",position:[0,0,0]})]})})};function as({imageUrl:e,position:t=[0,0,0],rotation:n=[0,0,0],scale:r=1,opacity:s=1}){const o=nt(e);y.useMemo(()=>{o.colorSpace=_t,o.anisotropy=4,o.wrapS=Ke,o.wrapT=Ke},[o]);const a=y.useMemo(()=>{const c=new ie({color:13214285,metalness:.9,roughness:.25,transparent:s<1,opacity:s}),l=new ie({color:7032366,metalness:.65,roughness:.4,transparent:s<1,opacity:s}),f=new ie({color:2826518,metalness:.25,roughness:.65,transparent:s<1,opacity:s});return{gold:c,bronze:l,dark:f}},[s]);return i.jsxs("group",{position:t,rotation:n,scale:r,children:[i.jsx("mesh",{geometry:ss,material:a.gold}),i.jsx("mesh",{geometry:os,material:a.bronze,rotation:[Math.PI/2,0,0],position:[0,0,-.05]}),i.jsx("mesh",{geometry:is,material:a.dark,rotation:[Math.PI/2,0,0],position:[0,0,.02]}),i.jsx("mesh",{position:[0,0,.21],geometry:Oe,children:i.jsx("meshStandardMaterial",{map:o,transparent:!0,alphaTest:.5,roughness:.5,emissive:"white",emissiveIntensity:.01})})]})}const j={getCell:H.getCell,updateCell:H.updateCell,updateCells:H.updateCells,initializeField:H.initializeField,getCellsByType:H.getCellsByType},cs=(e,t,n)=>{console.group(`[PlayCard] ðŸƒ Action: ${t.name} (ID: ${t.id})`),console.log(`Target: [x:${n.x}, y:${n.y}]`);let r=e;switch(t.cardType){case"alien":r=ls(e,t,n);break;case"eradication":r=ds(e,t,n);break;case"recovery":r=us(e,t,n);break;default:console.warn("[PlayCard] âš ï¸ Unknown card type");break}return console.groupEnd(),r},Tt=(e,t)=>e.find(n=>(Array.isArray(n.target)?n.target:[n.target]).includes(t)),Pt=e=>{const t=[];return e.forEach(n=>{const r=Array.isArray(n.target)?n.target:[n.target];t.push(...r)}),Array.from(new Set(t))},ls=(e,t,n)=>{const{gameField:r,alienInstances:s,currentRound:o}=e,a=j.getCell(r,n);if(!a)return e;const c=Pt(t.transition);if(!c.includes(a.type)){const u=`ãã“ã«ã¯é…ç½®ã§ãã¾ã›ã‚“ã€‚ï¼ˆå¯¾è±¡: ${c.join(", ")}ï¼‰`;return console.warn(`[PlayCard] âŒ ${u}`),ge.notify(u,"error"),e}const l=De(),f={instanceId:l,cardDefinitionId:t.id,spawnedRound:o,status:"seed",currentX:n.x,currentY:n.y},d={...a,type:"alien-core",ownerId:"alien",alienUnitId:l};return console.info(`[PlayCard] âœ… Success: Placed Seed (Core) at [${n.x}, ${n.y}]`),{...e,gameField:j.updateCell(r,d),alienInstances:{...s,[l]:f}}},ds=(e,t,n)=>{const{range:r,eradicationType:s,preventsCounter:o,transition:a}=t;let c={...e},l=0,f=0;if(s==="chain"){const p=j.getCell(c.gameField,n);if(!p||p.type!=="alien-core"){const h="é€£éŽ–é§†é™¤ã¯ã€Œå¤–æ¥ç¨®(Core)ã€ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚";return console.warn(`[PlayCard] âŒ ${h}`),ge.notify(h,"error"),e}}let d=[];if(s==="chain"){const p=j.getCell(c.gameField,n);p&&p.alienUnitId&&(d=j.getCellsByType(c.gameField,"alien").concat(j.getCellsByType(c.gameField,"alien-core")).filter(h=>j.getCell(c.gameField,h)?.alienUnitId===p.alienUnitId))}else d=Qe(c.gameField.width,c.gameField.height,n,r.shape,r.scale);const u=Pt(a);if(!d.some(p=>{const h=j.getCell(c.gameField,p);return!(!h||!u.includes(h.type))})){const p="åŠ¹æžœç¯„å›²å†…ã«å¯¾è±¡ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚";return console.warn(`[PlayCard] âŒ ${p}`),ge.notify(p,"error"),e}return d.forEach(p=>{const h=j.getCell(c.gameField,p);if(!h)return;if(h.type==="alien-core"&&h.alienUnitId){const S=h.alienUnitId,T=c.alienInstances[S];if(T){const x=s==="simple",I=On(T.cardDefinitionId)?.counterAbility==="spread_seed";x&&!o&&I&&(console.warn(`[PlayCard] âš ï¸ Counter Ability Triggered at [${p.x}, ${p.y}]!`),c=ps(c,p,T.cardDefinitionId));const b={...c.alienInstances};delete b[S],c.alienInstances=b,l++}}else h.type==="alien"&&l++;let E=null;if(s==="chain"&&(h.type==="alien"||h.type==="alien-core")){const S=Tt(a,"alien-core");S&&(E=S.result)}else{const S=Tt(a,h.type);S&&(E=S.result)}if(h.type==="alien-core"&&h.alienUnitId){const S=c.alienInstances[h.alienUnitId];S&&S.status==="seed"&&(E=null)}if(E){const S={...h,type:E,ownerId:null,alienUnitId:void 0};c.gameField=j.updateCell(c.gameField,S),f++}}),console.info(`[PlayCard] âœ… Success: Removed ${l} alien units, Affected ${f} cells.`),c},us=(e,t,n)=>{const{range:r,transition:s}=t,o={...e};let a=0;const c=Qe(o.gameField.width,o.gameField.height,n,r.shape,r.scale),l=Pt(s);return c.some(d=>{const u=j.getCell(o.gameField,d);return u&&l.includes(u.type)})?(c.forEach(d=>{const u=j.getCell(o.gameField,d);if(!u)return;const g=Tt(s,u.type);if(g){const p=g.result;let h=u.ownerId,E;if(p==="native"?h="native":p==="pioneer"&&(h=null,E=o.currentRound),p!==u.type){const S={...u,type:p,ownerId:h,pioneerCreatedAt:E};o.gameField=j.updateCell(o.gameField,S),a++}}}),console.info(`[PlayCard] âœ… Success: Recovered ${a} cells.`),o):(ge.notify("åŠ¹æžœç¯„å›²å†…ã«å¯¾è±¡ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚","error"),e)},ps=(e,t,n)=>{const r={...e},{gameField:s}=r,a=j.getCellsByType(s,"bare").filter(p=>!(p.x===t.x&&p.y===t.y)),c=Math.random()<.5?2:1,l=Math.min(a.length,c);if(l===0)return console.log("[Counter] No available bare cells for counter spread."),r;const d=a.sort(()=>.5-Math.random()).slice(0,l);console.log(`[Counter] Spawning ${l} seeds (Target: ${c}) from ${n}`);const u=On(n),g=u?u.name:"å¤–æ¥ç¨®";return ge.notify(`ã€åæ’ƒã€‘${g}ãŒç¨®å­ã‚’æ‹¡æ•£ã—ã¾ã—ãŸ`,"system","broadcast"),d.forEach(p=>{const h=De(),E=r.currentRound+1,S={instanceId:h,cardDefinitionId:n,spawnedRound:E,status:"seed",currentX:p.x,currentY:p.y},x={...j.getCell(r.gameField,p),type:"alien-core",ownerId:"alien",alienUnitId:h};r.gameField=j.updateCell(r.gameField,x),r.alienInstances={...r.alienInstances,[h]:S}}),r},Qe=(e,t,n,r,s=1)=>{const o=[],{x:a,y:c}=n,l=(d,u)=>{d>=0&&d<e&&u>=0&&u<t&&o.push({x:d,y:u})};for(let d=1;d<=s;d++)switch(r){case"point":d===1&&l(a,c);break;case"vertical":l(a,c),l(a,c-d),l(a,c+d);break;case"horizon":l(a,c),l(a-d,c),l(a+d,c);break;case"cross":d===1&&l(a,c),l(a,c-d),l(a,c+d),l(a-d,c),l(a+d,c);break;case"x_cross":d===1&&l(a,c),l(a-d,c-d),l(a+d,c-d),l(a-d,c+d),l(a+d,c+d);break;case"range":for(let u=-d;u<=d;u++)for(let g=-d;g<=d;g++)(Math.abs(g)===d||Math.abs(u)===d)&&l(a+g,c+u);break}return r==="point"&&o.length===0&&l(a,c),Array.from(new Set(o.map(d=>`${d.x},${d.y}`))).map(d=>{const[u,g]=d.split(",").map(Number);return{x:u,y:g}})},On=e=>q.find(t=>t.id===e&&t.cardType==="alien"),fs=()=>{const e=O(u=>u.hoveredCell),t=O(u=>u.selectedCardId),n=N.useField(),r=N.useActivePlayer(),s=N.usePlayer(r),o=y.useMemo(()=>{if(!t)return null;if(s){const g=s.cardLibrary.find(p=>p.instanceId===t);if(g)return q.find(p=>p.id===g.cardDefinitionId)??null}const u=q.find(g=>g.id===t);return u||null},[t,s]);y.useEffect(()=>{t&&!o&&console.warn(`[PlacementGuide] Card ID '${t}' not found.`)},[t,o]);const a=(u,g,p,h)=>{const E=h.cells[g]?.[u];if(!E)return!1;const S=[];if(p.transition.forEach(T=>{const x=Array.isArray(T.target)?T.target:[T.target];S.push(...x)}),p.cardType==="alien"||p.cardType==="eradication"&&p.eradicationType==="chain")return S.includes(E.type);if(p.cardType==="eradication"||p.cardType==="recovery"){const{shape:T,scale:x}=p.range;return Qe(h.width,h.height,{x:u,y:g},T,x).some(I=>{const b=h.cells[I.y]?.[I.x];return b&&S.includes(b.type)})}return!1},c=y.useMemo(()=>{if(!o||!n)return[];const u=[];for(let g=0;g<n.height;g++)for(let p=0;p<n.width;p++){const h=a(p,g,o,n);u.push({x:p,y:g,isValid:h})}return u},[o,n]),l=y.useMemo(()=>{if(!e||!o||!n)return[];if(o.cardType==="eradication"&&o.eradicationType==="chain"){const p=j.getCell(n,e);if(p&&p.type==="alien-core"&&p.alienUnitId)return[...j.getCellsByType(n,"alien"),...j.getCellsByType(n,"alien-core")].filter(E=>j.getCell(n,E)?.alienUnitId===p.alienUnitId)}const{shape:u,scale:g}=o.range;return Qe(n.width,n.height,{x:e.x,y:e.y},u,g)},[e,o,n]),f=y.useMemo(()=>!e||!o?null:{x:e.x,y:e.y},[e,o]);return{allCellGuides:c,effectRange:l,previewPosition:f,selectedCard:o,getPosition:(u,g,p=.05)=>{const h=(u-3)*k.BOARD.CELL_GAP,E=(g-9/2)*k.BOARD.CELL_GAP;return[h,p,E]},isVisible:!!(o&&n)}},L=new br,hs=()=>{const{allCellGuides:e,effectRange:t,previewPosition:n,selectedCard:r,getPosition:s,isVisible:o}=fs(),a=O(h=>h.isHoverValid),{validGuides:c,invalidGuides:l}=y.useMemo(()=>{const h=[],E=[];for(const S of e)S.isValid?h.push(S):E.push(S);return{validGuides:h,invalidGuides:E}},[e]),f=y.useRef(null),d=y.useRef(null),u=y.useRef(null),g=y.useRef(null);if(y.useLayoutEffect(()=>{if(f.current&&c.length>0){const h=f.current;c.forEach((E,S)=>{const[T,x,C]=s(E.x,E.y,.02);L.position.set(T,x,C),L.rotation.set(-Math.PI/2,0,0),L.scale.set(1,1,1),L.updateMatrix(),h.setMatrixAt(S,L.matrix)}),h.instanceMatrix.needsUpdate=!0}if(d.current&&l.length>0){const h=d.current;l.forEach((E,S)=>{const[T,x,C]=s(E.x,E.y,.02);L.position.set(T,x,C),L.rotation.set(-Math.PI/2,0,Math.PI/4),L.scale.set(1,1,1),L.updateMatrix(),h.setMatrixAt(S*2,L.matrix),L.rotation.set(-Math.PI/2,0,-Math.PI/4),L.updateMatrix(),h.setMatrixAt(S*2+1,L.matrix)}),h.instanceMatrix.needsUpdate=!0}if(u.current&&g.current&&t.length>0){const h=u.current,E=g.current;t.forEach((S,T)=>{const[x,C,I]=s(S.x,S.y,.03);L.position.set(x,C,I),L.rotation.set(-Math.PI/2,0,0),L.scale.set(1,1,1),L.updateMatrix(),h.setMatrixAt(T,L.matrix),L.position.set(x,C+.01,I),L.updateMatrix(),E.setMatrixAt(T,L.matrix)}),h.instanceMatrix.needsUpdate=!0,E.instanceMatrix.needsUpdate=!0}},[c,l,t,s]),!o)return null;const p=a?.7:.3;return i.jsxs("group",{name:"guide-layer",children:[c.length>0&&i.jsxs("instancedMesh",{ref:f,args:[void 0,void 0,c.length],raycast:()=>null,children:[i.jsx("ringGeometry",{args:[.4,.45,4],rotateZ:Math.PI/4}),i.jsx("meshBasicMaterial",{color:"#00FFFF",opacity:.5,transparent:!0,side:wr})]}),l.length>0&&i.jsxs("instancedMesh",{ref:d,args:[void 0,void 0,l.length*2],raycast:()=>null,children:[i.jsx("planeGeometry",{args:[.7,.08]}),i.jsx("meshBasicMaterial",{color:"#FF3333",opacity:.5,transparent:!0})]}),t.length>0&&i.jsxs(i.Fragment,{children:[i.jsxs("instancedMesh",{ref:u,args:[void 0,void 0,t.length],raycast:()=>null,children:[i.jsx("planeGeometry",{args:[.8,.8]}),i.jsx("meshBasicMaterial",{color:"#00FFFF",opacity:p,transparent:!0})]}),i.jsxs("instancedMesh",{ref:g,args:[void 0,void 0,t.length],raycast:()=>null,children:[i.jsx("ringGeometry",{args:[.38,.42,32]}),i.jsx("meshBasicMaterial",{color:"#00FFFF",opacity:.8,transparent:!0})]})]}),n&&r?.cardType==="alien"&&i.jsx("group",{name:"preview-token",children:i.jsx(vn,{x:n.x,y:n.y,status:"seed",isPreview:!0,isReady:a})})]})},gs=({width:e,height:t,thickness:n,...r})=>i.jsxs("mesh",{position:[0,-n,0],receiveShadow:!0,...r,children:[i.jsx("boxGeometry",{args:[e,n,t]}),i.jsx("meshStandardMaterial",{color:"#8b5a2b",roughness:.8,metalness:.1})]}),ms=()=>{const e=rt(n=>n.gl),t=y.useRef(null);return y.useEffect(()=>{const n=document.createElement("div");n.style.cssText=`
      position: absolute;
      top: 60px; /* Statsã®ä¸‹ã‚ãŸã‚Š */
      left: 0px;
      background: rgba(0, 0, 0, 0.7);
      color: #00ff00;
      padding: 8px;
      font-family: monospace;
      font-size: 12px;
      pointer-events: none;
      z-index: 9999;
      min-width: 120px;
    `,document.body.appendChild(n),t.current=n;const r=e.info.autoReset;return e.info.autoReset=!1,()=>{n.parentNode&&n.parentNode.removeChild(n),e.info.autoReset=r}},[e]),En(()=>{if(!t.current)return;const{render:n,memory:r}=e.info;t.current.innerHTML=`
      <div style="font-weight:bold; margin-bottom:4px">Render Stats</div>
      <div>Calls: ${n.calls}</div>
      <div>Triangles: ${n.triangles}</div>
      <div>Points: ${n.points}</div>
      <div>Lines: ${n.lines}</div>
      <div style="margin-top:4px; border-top:1px solid #555; paddingTop:2px">
        Geometries: ${r.geometries}
      </div>
      <div>Textures: ${r.textures}</div>
    `,e.info.reset()}),null},Es=()=>{const{scene:e,gl:t}=rt(),n=y.useRef(1e3),r=y.useRef({});return y.useEffect(()=>(n.current=window.setInterval(()=>{const s=t.info.memory.geometries,o={},a=new Set;e.traverse(d=>{if(d instanceof _r&&d.geometry&&!a.has(d.geometry.uuid)){a.add(d.geometry.uuid);const u=d.geometry.type;o[u]=(o[u]||0)+1}});let c=!1;const l=[];new Set([...Object.keys(o),...Object.keys(r.current)]).forEach(d=>{const u=o[d]||0,g=r.current[d]||0,p=u-g;if(p!==0){c=!0;const h=p>0?"+":"";l.push(`${d}: ${g} -> ${u} (${h}${p})`)}}),c&&(console.groupCollapsed(`ðŸ“Š Geometry Diff (Total: ${s})`),l.forEach(d=>{d.includes("+")?console.log(`%c${d}`,"color: red"):console.log(`%c${d}`,"color: green")}),console.groupEnd()),r.current=o},1e3),()=>clearInterval(n.current)),[e,t]),null},ys=()=>{const e=N.useField(),t=N.useActiveAliens(),n=y.useRef(null),r=O(p=>p.deselectCard),s=O(p=>p.hoverCell),o=O(p=>p.debugSettings.showFps);if(y.useEffect(()=>{const p=()=>{s(null)};return window.addEventListener("pointerup",p),window.addEventListener("pointercancel",p),()=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",p)}},[s]),!e||!e.cells)return null;const a=e.cells.length,c=e.cells[0]?.length??0,l=e.width*1.05,f=e.height*1.05,d=p=>{p.stopPropagation(),r()},u=p=>{p.stopPropagation(),s(null)},g=p=>{p.stopPropagation()};return i.jsxs(i.Fragment,{children:[o&&i.jsxs(i.Fragment,{children:[i.jsx(hr,{}),i.jsx(ms,{}),i.jsx(Es,{})]}),i.jsxs("group",{ref:n,children:[i.jsx("mesh",{position:[0,-.1,0],rotation:[-Math.PI/2,0,0],onClick:d,onPointerOver:u,visible:!1,children:i.jsx("planeGeometry",{args:[100,100]})}),c>0&&a>0&&i.jsx(gs,{width:l,height:f,thickness:.1,onPointerOver:g}),i.jsx("group",{name:"grid-layer",position:[0,.01,0],children:e.cells.flat().map(p=>i.jsx(Qr,{cell:p},`cell-${p.x}-${p.y}`))}),i.jsx("group",{name:"token-layer",position:[0,.05,0],children:Object.values(t).map(p=>i.jsx(vn,{x:p.currentX,y:p.currentY,status:p.status,cardDefinitionId:p.cardDefinitionId},`alien-${p.instanceId}`))}),i.jsx("group",{position:[0,.07,0],children:i.jsx(hs,{})})]})]})},Ss={key:"field-grid",renderUI:e=>e==="main-3d"?i.jsx(ys,{}):null},m={CARD_BASE:{WIDTH:2.9,HEIGHT:4.4,THICKNESS:.15,CORNER_RADIUS:.075,BORDER_THICKNESS:.09,get Z_SURFACE(){return .0765}},layers:{BASE:0,BASE_INNER:.001,HEADER:.005,IMAGE:.007,DESC_BG:.007,COST_BG:.009,TEXT:.01,OVERLAY:.02,DIM_OVERLAY:.021},getZ(e){return this.CARD_BASE.Z_SURFACE+e},AREAS:{BASE_INNER:{get WIDTH(){return m.CARD_BASE.WIDTH-m.CARD_BASE.BORDER_THICKNESS*2},get HEIGHT(){return m.CARD_BASE.HEIGHT-m.CARD_BASE.BORDER_THICKNESS*2},get CONTENT_WIDTH(){return this.WIDTH-.15},get CONTENT_HEIGHT(){return this.HEIGHT-.15},get CORNER_RADIUS(){return Math.max(0,m.CARD_BASE.CORNER_RADIUS-m.CARD_BASE.BORDER_THICKNESS/2)},get POSITION(){return[0,0,m.getZ(m.layers.BASE_INNER)]}},HEADER:{TOP_Y_OFFSET:.015,SIDE_EDGE_Y_OFFSET:.075,CURVE_AMPLITUDE:.09,BEZIER_CONTROL_X_RATIO:1/3,BEZIER_TANGENT_X_RATIO:1/6,get SIZE(){return[m.AREAS.BASE_INNER.CONTENT_WIDTH,m.AREAS.BASE_INNER.CONTENT_HEIGHT/6]},get TOP_LINE(){return m.AREAS.BASE_INNER.CONTENT_HEIGHT/2-this.TOP_Y_OFFSET},get CENTER_LINE(){return this.TOP_LINE-this.SIZE[1]/2},get BOTTOM_LINE(){return this.TOP_LINE-this.SIZE[1]},get POSITION(){return[0,0,m.getZ(m.layers.HEADER)]}},COST:{RADIUS:.1875,X_OFFSET:.285,Y_OFFSET:.285,get POSITION(){return[m.CARD_BASE.WIDTH/2-this.X_OFFSET,m.CARD_BASE.HEIGHT/2-this.Y_OFFSET,m.getZ(m.layers.COST_BG)]}},USAGE_LIMIT:{RADIUS:.15,X_OFFSET:.285,Y_OFFSET:.285,get POSITION(){return[m.CARD_BASE.WIDTH/2-this.X_OFFSET,-(m.CARD_BASE.HEIGHT/2-this.Y_OFFSET),m.getZ(m.layers.COST_BG)]}},IMAGE:{TOP_Y_OFFSET:.015,IMAGE_PLANE_HEIGHT:1.5,get SIZE(){return[m.AREAS.BASE_INNER.CONTENT_WIDTH,this.IMAGE_PLANE_HEIGHT]},get TOP_LINE(){return m.AREAS.HEADER.BOTTOM_LINE-this.TOP_Y_OFFSET},get CENTER_LINE(){return this.TOP_LINE-this.SIZE[1]/2},get BOTTOM_LINE(){return this.TOP_LINE-this.SIZE[1]},get POSITION(){return[0,this.CENTER_LINE,m.getZ(m.layers.IMAGE)]}},DESC:{TOP_Y_OFFSET:.075,PLANE_HEIGHT:1.8,get SIZE(){return[m.AREAS.BASE_INNER.CONTENT_WIDTH,this.PLANE_HEIGHT]},get TOP_LINE(){return m.AREAS.IMAGE.BOTTOM_LINE-this.TOP_Y_OFFSET},get CENTER_LINE(){return this.TOP_LINE-this.SIZE[1]/2},get POSITION(){return[0,this.CENTER_LINE,m.getZ(m.layers.DESC_BG)]}},COOLDOWN:{OPACITY:.85,COLOR:"#aaddff",TEXTURE_SCALE:1,get POSITION(){return[0,0,m.getZ(m.layers.OVERLAY+.02)]},get SIZE(){return[m.CARD_BASE.WIDTH,m.CARD_BASE.HEIGHT]}},DIM_OVERLAY:{COLOR:"black",OPACITY:.2,get POSITION(){return[0,0,m.getZ(m.layers.DIM_OVERLAY)]},get SIZE(){return[m.CARD_BASE.WIDTH,m.CARD_BASE.HEIGHT]}},TEXT:{HEADER:{FONT:"MPLUS1p-Bold.ttf",FONT_SIZE:.21,ANCHOR_X:"center",ANCHOR_Y:"middle",get POSITION(){return[0,m.AREAS.HEADER.CENTER_LINE,m.getZ(m.layers.HEADER+.01)]}},COST:{FONT:"MPLUS1p-Bold.ttf",FONT_SIZE:.24,COLOR:"black",get POSITION(){const[e,t,n]=m.AREAS.COST.POSITION;return[e,t,n+.01]}},USAGE_LIMIT:{FONT:"MPLUS1p-Bold.ttf",FONT_SIZE:.18,COLOR:"white",get POSITION(){const[e,t,n]=m.AREAS.USAGE_LIMIT.POSITION;return[e,t,n+.01]}},DESC:{FONT:"MPLUS1p-Regular.ttf",FONT_SIZE:.135,LINE_HEIGHT:1.2,ANCHOR_X:"center",ANCHOR_Y:"top",OVERFLOW_WRAP:"break-word",PADDING_TOP:.075,get POSITION(){const[e,t,n]=m.AREAS.DESC.POSITION,r=m.AREAS.DESC.PLANE_HEIGHT;return[e,t+r/2-this.PADDING_TOP,n+.01]},get MAX_WIDTH(){return m.AREAS.BASE_INNER.CONTENT_WIDTH-.18}},COOLDOWN:{FONT:"MPLUS1p-Bold.ttf",FONT_SIZE:.75,COLOR:"#004488",ANCHOR_X:"center",ANCHOR_Y:"middle",get POSITION(){return[0,0,m.getZ(m.layers.OVERLAY+.03)]}}}},COLORS:{BORDER:"#B8860B",CARD_UI:k.COLORS.CARD_UI,CARD_TYPES:k.COLORS.CARD_TYPES,USAGE_LIMIT_BG:"#444"}},oe=m.COLORS,_={CARDS_PER_PAGE:3,CARD_GAP_X:.2,PAGE_GAP_X:3,POSITION:{X:0,Y:1.5,Z:{VISIBLE:4,HIDDEN:7}},CARD:{ROTATION:{X:-(Math.PI/2.2),Y:0,Z:0}},GESTURE:{PLANE_PADDING_X:1,PLANE_HEIGHT:4.5,ROTATION:{X:-Math.PI/2,Y:0,Z:0},POSITION:{X:0,Y:-.3,Z:-.225},MATERIAL:{OPACITY:0,DEPTH_WRITE:!1}},ANIMATION:{Z_SELECTED:2.5,Z_DEFAULT:0,SPRING_CONFIG:{tension:700,friction:40}},get PAGE_WIDTH(){return this.CARDS_PER_PAGE*m.CARD_BASE.WIDTH+(this.CARDS_PER_PAGE-1)*this.CARD_GAP_X},calcCardXLocal(e){const t=this.PAGE_WIDTH,n=m.CARD_BASE.WIDTH,r=this.CARD_GAP_X;return-t/2+e*(n+r)+n/2},calcDimState(e){const{isVisible:t,isAnySelected:n,isSelected:r}=e;return t?n?!r:!1:!0},calcTargetZ(e){const{isSelected:t,isAnySelected:n,isVisible:r}=e;if(t){if(r)return this.ANIMATION.Z_SELECTED;{const s=this.POSITION.Z.HIDDEN-this.POSITION.Z.VISIBLE;return this.ANIMATION.Z_SELECTED-s}}return r&&n?this.POSITION.Z.HIDDEN-this.POSITION.Z.VISIBLE:0},calcGesturePlaneArgs(e){return[e+this.GESTURE.PLANE_PADDING_X,this.GESTURE.PLANE_HEIGHT]},calcPageOffsetX(e){const{pageIndex:t,pageWidth:n}=e;return t*(n+this.PAGE_GAP_X)}},Is=(e,t)=>{const[n,r]=y.useState(!0),s=n&&!e&&t,{zPos:o}=st({zPos:s?_.POSITION.Z.VISIBLE:_.POSITION.Z.HIDDEN,config:_.ANIMATION.SPRING_CONFIG});return{state:{isVisible:n,effectiveIsVisible:s},animation:{zPos:o},actions:{show:y.useCallback(()=>r(!0),[]),hide:y.useCallback(()=>r(!1),[]),toggle:y.useCallback(()=>r(a=>!a),[])}}},Ts=()=>{const e=N.ui.useSelectedCardId(),t=y.useCallback(r=>{console.log(`[CardSelect] card: ${r}`),$.ui.selectCard(r)},[]),n=y.useCallback(()=>{console.log(`[CardDeselect] card: ${e}`),$.ui.deselectCard()},[]);return{selectedCardId:e,isAnySelected:!!e,actions:{select:t,deselect:n}}},xs=e=>{const t=N.usePlayer(e),n=N.useActivePlayer(),r=N.ui.useIsInteractionLocked(),[s,o]=y.useState(0),a=t?.facingFactor??1,c=n===e,{selectedCardId:l,isAnySelected:f,actions:d}=Ts(),u=y.useMemo(()=>(t?.cardLibrary??[]).map(b=>{const v=q.find(R=>R.id===b.cardDefinitionId);return v?{...v,instanceId:b.instanceId}:null}).filter(Boolean),[t?.cardLibrary]),g=y.useMemo(()=>u.some(I=>I.instanceId===l),[u,l]);y.useEffect(()=>{!c&&g&&(console.log(`[UI] ðŸ”„ Turn Ended for ${e}: Deselecting my card.`),d.deselect())},[c,g,d,e]);const{state:p,animation:h,actions:E}=Is(f,c),S=Math.max(0,Math.ceil(u.length/_.CARDS_PER_PAGE)-1),T=_.PAGE_WIDTH,{xPos:x}=st({xPos:-s*(T+_.PAGE_GAP_X),config:_.ANIMATION.SPRING_CONFIG}),C={onSwipeUp:y.useCallback(()=>E.show(),[E]),onSwipeDown:y.useCallback(()=>E.hide(),[E]),onSwipeLeft:y.useCallback(()=>o(I=>Math.min(S,I+1)),[S]),onSwipeRight:y.useCallback(()=>o(I=>Math.max(0,I-1)),[]),onAreaClick:y.useCallback(()=>{f&&d.deselect()},[f,d]),onCardSelect:y.useCallback(I=>{if(r||!c)return;if(t?.cooldownActiveCards.some(v=>v.cardId===I.instanceId)){$.ui.notify({message:"ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ä¸­ã§ã™"});return}if(I.usageLimit!==void 0&&(t?.limitedCardsUsedCount?.[I.id]??0)>=I.usageLimit){$.ui.notify({message:"ä½¿ç”¨å›žæ•°åˆ¶é™ã«é”ã—ã¦ã„ã¾ã™"});return}d.select(I.instanceId)},[r,c,t,d]),onCardDeselect:y.useCallback(()=>d.deselect(),[d])};return{state:{cards:u,isVisible:p.isVisible,effectiveIsVisible:p.effectiveIsVisible,isAnySelected:f,selectedCardId:l,isInteractionLocked:r,isMyTurn:c},layout:{facingFactor:a,zPos:h.zPos,xPos:x,pageWidth:T},handlers:C}},Cs=({card:e,player:t})=>{const[n,r]=y.useState(!1),[s,o]=y.useState("https://placehold.co/256x160/ccc/999?text=Loading"),a=N.ui.useSelectedCardId(),c=N.useActivePlayer(),l=N.usePlayer(t),f=l?.cooldownActiveCards.find(I=>I.cardId===e.instanceId),d=!!f,u=a===e.instanceId,g=c===t,p=e.usageLimit!==void 0,h=l?.limitedCardsUsedCount?.[e.id]??0,E=p?e.usageLimit-h:void 0,S=p?E>0:!0,T=g&&!d&&S;y.useEffect(()=>{const I=new Image;I.crossOrigin="Anonymous",I.src=e.imagePath,I.onload=()=>o(e.imagePath)},[e.imagePath]);const x=y.useMemo(()=>{switch(e.cardType){case"alien":return oe.CARD_TYPES.ALIEN;case"eradication":return oe.CARD_TYPES.ERADICATION;case"recovery":return oe.CARD_TYPES.RECOVERY;default:return oe.CARD_TYPES.DEFAULT}},[e.cardType]),C=u?oe.CARD_UI.BORDER_SELECTED:n?oe.CARD_UI.BORDER_HOVER:oe.CARD_UI.BORDER_DEFAULT;return{state:{isHovered:n,isSelected:u,isPlayable:T,isCooldown:d,isMyTurn:g,isUsable:S},data:{textureUrl:s,headerColor:x,borderStateColor:C,cooldownRounds:f?.roundsRemaining,remainingUses:E,hasUsageLimit:p},handlers:{setIsHovered:r}}},zt=(e,t)=>{e.bezierCurveTo(t.cp1.x,t.cp1.y,t.cp2.x,t.cp2.y,t.end.x,t.end.y)},As=()=>{const e=m.AREAS.HEADER,[t]=e.SIZE,n=e.TOP_LINE,r=e.BOTTOM_LINE,s=t/2,o=-s,a=s,c=n-e.SIDE_EDGE_Y_OFFSET,l=n+e.CURVE_AMPLITUDE,f=n-e.CURVE_AMPLITUDE,d=t*e.BEZIER_CONTROL_X_RATIO,u=t*e.BEZIER_TANGENT_X_RATIO;return{leftBottom:{x:o,y:r},rightBottom:{x:a,y:r},leftTop:{x:o,y:n},rightTop:{x:a,y:n},leftSideDip:{x:o,y:c},rightSideDip:{x:a,y:c},leftEntryTangent:{x:o,y:n},leftCrest:{x:-d,y:l},leftTangent:{x:-u,y:n},centerValley:{x:0,y:f},rightTangent:{x:u,y:n}}},Rs=e=>{const t={cp1:e.leftEntryTangent,cp2:e.leftCrest,end:e.leftTangent},n={cp1:e.centerValley,cp2:e.rightTangent,end:e.rightSideDip};return{leftCurve:t,rightCurve:n}},vs=(e={})=>{const{debugNoCurves:t=!1}=e,n=new ot,r=As();if(n.moveTo(r.leftBottom.x,r.leftBottom.y),t)return n.lineTo(r.leftTop.x,r.leftTop.y),n.lineTo(r.rightTop.x,r.rightTop.y),n.lineTo(r.rightBottom.x,r.rightBottom.y),n.closePath(),n;const{leftCurve:s,rightCurve:o}=Rs(r);return n.lineTo(r.leftSideDip.x,r.leftSideDip.y),zt(n,s),zt(n,o),n.lineTo(r.rightBottom.x,r.rightBottom.y),n.closePath(),n},Os=()=>{const e=new ot,t=m.AREAS.BASE_INNER,n=t.WIDTH,r=t.HEIGHT,s=t.CORNER_RADIUS,o=-n/2,a=n/2,c=-r/2,l=r/2;return e.moveTo(o,c+s),e.lineTo(o,l-s),e.quadraticCurveTo(o,l,o+s,l),e.lineTo(a-s,l),e.quadraticCurveTo(a,l,a,l-s),e.lineTo(a,c+s),e.quadraticCurveTo(a,c,a-s,c),e.lineTo(o+s,c),e.quadraticCurveTo(o,c,o,c+s),e},bn=re.meshStandardMaterial,Le=re.meshBasicMaterial,bs=({card:e,player:t,isDimmed:n})=>{const{state:r,data:s,handlers:o}=Cs({card:e,player:t}),a=y.useMemo(()=>Os(),[]),c=y.useMemo(()=>vs(),[]);return i.jsxs(re.group,{onPointerEnter:()=>r.isPlayable&&o.setIsHovered(!0),onPointerLeave:()=>o.setIsHovered(!1),children:[i.jsx(ws,{isSelected:r.isSelected,borderStateColor:s.borderStateColor}),i.jsx(_s,{baseShape:a}),i.jsx(Ps,{card:e,headerShape:c,data:s}),i.jsx(Ns,{card:e}),i.jsx(Ls,{textureUrl:s.textureUrl}),i.jsx(js,{card:e}),s.hasUsageLimit&&i.jsx(Ds,{remainingUses:s.remainingUses}),i.jsx(Fs,{isCooldown:r.isCooldown,cooldownRounds:s.cooldownRounds}),i.jsx(Ms,{isUsable:r.isUsable}),i.jsx(Gs,{isDimmed:n})]})},ws=({isSelected:e,borderStateColor:t})=>{const{CARD_BASE:n}=m;return i.jsx(yn,{args:[n.WIDTH,n.HEIGHT,n.THICKNESS],radius:n.CORNER_RADIUS,children:i.jsx(bn,{color:t,emissive:e?t:"black",emissiveIntensity:e?.5:0})})},_s=({baseShape:e})=>i.jsxs("mesh",{position:m.AREAS.BASE_INNER.POSITION,children:[i.jsx("shapeGeometry",{args:[e]}),i.jsx(bn,{color:m.COLORS.CARD_UI.BASE_BG})]}),Ps=({card:e,headerShape:t,data:n})=>i.jsxs(i.Fragment,{children:[i.jsxs("mesh",{position:m.AREAS.HEADER.POSITION,children:[i.jsx("shapeGeometry",{args:[t]}),i.jsx(Le,{color:n.headerColor})]}),i.jsx(Ne,{position:m.AREAS.TEXT.HEADER.POSITION,font:m.AREAS.TEXT.HEADER.FONT,fontSize:m.AREAS.TEXT.HEADER.FONT_SIZE,color:m.COLORS.CARD_UI.TEXT_WHITE,anchorX:m.AREAS.TEXT.HEADER.ANCHOR_X,anchorY:m.AREAS.TEXT.HEADER.ANCHOR_Y,maxWidth:m.AREAS.BASE_INNER.CONTENT_WIDTH,children:e.name})]}),Ns=({card:e})=>i.jsxs(i.Fragment,{children:[i.jsxs("mesh",{position:m.AREAS.COST.POSITION,children:[i.jsx("circleGeometry",{args:[m.AREAS.COST.RADIUS,32]}),i.jsx(Le,{color:m.COLORS.BORDER})]}),i.jsx(Ne,{position:m.AREAS.TEXT.COST.POSITION,fontSize:m.AREAS.TEXT.COST.FONT_SIZE,font:m.AREAS.TEXT.COST.FONT,color:m.AREAS.TEXT.COST.COLOR,anchorX:"center",anchorY:"middle",children:e.cost})]}),Ds=({remainingUses:e})=>i.jsxs(i.Fragment,{children:[i.jsxs("mesh",{position:m.AREAS.USAGE_LIMIT.POSITION,children:[i.jsx("circleGeometry",{args:[m.AREAS.USAGE_LIMIT.RADIUS,32]}),i.jsx(Le,{color:m.COLORS.USAGE_LIMIT_BG})]}),i.jsx(Ne,{position:m.AREAS.TEXT.USAGE_LIMIT.POSITION,fontSize:m.AREAS.TEXT.USAGE_LIMIT.FONT_SIZE,font:m.AREAS.TEXT.USAGE_LIMIT.FONT,color:m.AREAS.TEXT.USAGE_LIMIT.COLOR,anchorX:"center",anchorY:"middle",children:e})]}),Ls=({textureUrl:e})=>{const t=nt(e);return i.jsxs(re.mesh,{position:m.AREAS.IMAGE.POSITION,children:[i.jsx("planeGeometry",{args:m.AREAS.IMAGE.SIZE}),i.jsx("meshStandardMaterial",{map:t})]})},js=({card:e})=>i.jsxs(i.Fragment,{children:[i.jsxs("mesh",{position:m.AREAS.DESC.POSITION,children:[i.jsx("planeGeometry",{args:m.AREAS.DESC.SIZE}),i.jsx(Le,{color:m.COLORS.CARD_UI.DESC_BG})]}),i.jsx(Ne,{position:m.AREAS.TEXT.DESC.POSITION,font:m.AREAS.TEXT.DESC.FONT,fontSize:m.AREAS.TEXT.DESC.FONT_SIZE,color:m.COLORS.CARD_UI.TEXT_BLACK,anchorX:m.AREAS.TEXT.DESC.ANCHOR_X,anchorY:m.AREAS.TEXT.DESC.ANCHOR_Y,maxWidth:m.AREAS.TEXT.DESC.MAX_WIDTH,lineHeight:m.AREAS.TEXT.DESC.LINE_HEIGHT,overflowWrap:m.AREAS.TEXT.DESC.OVERFLOW_WRAP,children:e.description})]}),Fs=({isCooldown:e,cooldownRounds:t})=>e?i.jsxs(i.Fragment,{children:[i.jsxs("mesh",{position:m.AREAS.COOLDOWN.POSITION,children:[i.jsx("planeGeometry",{args:m.AREAS.COOLDOWN.SIZE}),i.jsx("meshStandardMaterial",{color:m.AREAS.COOLDOWN.COLOR,transparent:!0,opacity:m.AREAS.COOLDOWN.OPACITY,roughness:.1,metalness:.2,depthWrite:!1})]}),i.jsx(Ne,{position:m.AREAS.TEXT.COOLDOWN.POSITION,fontSize:m.AREAS.TEXT.COOLDOWN.FONT_SIZE,font:m.AREAS.TEXT.COOLDOWN.FONT,color:m.AREAS.TEXT.COOLDOWN.COLOR,anchorX:"center",anchorY:"middle",children:t})]}):null,Ms=({isUsable:e})=>e?null:i.jsxs("mesh",{position:m.AREAS.COOLDOWN.POSITION,children:[i.jsx("planeGeometry",{args:m.AREAS.COOLDOWN.SIZE}),i.jsx("meshBasicMaterial",{color:"#330000",transparent:!0,opacity:.7,depthWrite:!1})]}),Gs=({isDimmed:e})=>{const{opacity:t}=st({opacity:e?m.AREAS.DIM_OVERLAY.OPACITY:0,config:{tension:400,friction:30}});return i.jsxs(re.mesh,{position:m.AREAS.DIM_OVERLAY.POSITION,visible:t.to(n=>n>.01),children:[i.jsx("planeGeometry",{args:m.AREAS.DIM_OVERLAY.SIZE}),i.jsx(Le,{color:m.AREAS.DIM_OVERLAY.COLOR,transparent:!0,opacity:t,depthWrite:!1})]})},ks=({onSwipeUp:e,onSwipeDown:t,onSwipeLeft:n,onSwipeRight:r,onClick:s,facingFactor:o,enabled:a})=>{const{showGestureArea:c}=N.ui.useDebugSettings(),l=gr({onDrag:({movement:[d,u],velocity:[g,p],direction:[h,E],last:S,tap:T,event:x})=>{if(T||!S)return;x.stopPropagation();const C=45,I=.5;if(Math.abs(u)>Math.abs(d)&&Math.abs(u)>C&&Math.abs(p)>I*.5){E*o<0?e?.():t?.();return}Math.abs(d)>Math.abs(u)&&Math.abs(d)>C&&Math.abs(g)>I&&(h*o>0?r?.():n?.())},onClick:({event:d})=>{d.stopPropagation(),s?.()}},{enabled:a,drag:{filterTaps:!0,threshold:10}}),f=_.calcGesturePlaneArgs(_.PAGE_WIDTH);return i.jsx(mr,{args:f,rotation:[_.GESTURE.ROTATION.X,_.GESTURE.ROTATION.Y,_.GESTURE.ROTATION.Z],position:[_.GESTURE.POSITION.X,_.GESTURE.POSITION.Y,_.GESTURE.POSITION.Z],...l(),children:i.jsx("meshStandardMaterial",{transparent:!0,opacity:c?.3:_.GESTURE.MATERIAL.OPACITY,color:c?"#ff00ff":"white",depthWrite:_.GESTURE.MATERIAL.DEPTH_WRITE})})},Bs=({card:e,index:t,player:n,isSelected:r,isAnySelected:s,isVisible:o,onSelect:a,onDeselect:c})=>{const l=_.calcCardXLocal(t),f=_.calcDimState({isVisible:o,isAnySelected:s,isSelected:r}),d=_.calcTargetZ({isSelected:r,isAnySelected:s,isVisible:o}),u=st({position:[l,0,d],rotation:[_.CARD.ROTATION.X,_.CARD.ROTATION.Y,_.CARD.ROTATION.Z],config:_.ANIMATION.SPRING_CONFIG});return i.jsx(re.group,{position:u.position,rotation:u.rotation,onClick:g=>{g.stopPropagation(),console.log(`[CardClick] isSelected: ${r}, isAnySelected: ${s}`),r?c():a(e)},children:i.jsx(bs,{card:e,player:n,isDimmed:f})})},Yt=({player:e})=>{const{state:t,layout:n,handlers:r}=xs(e);if(t.cards.length===0)return null;const s=[];for(let o=0;o<t.cards.length;o+=_.CARDS_PER_PAGE)s.push(t.cards.slice(o,o+_.CARDS_PER_PAGE));return i.jsxs(re.group,{position:Er([n.zPos],o=>[_.POSITION.X,_.POSITION.Y,o*n.facingFactor]),rotation:[0,n.facingFactor===-1?Math.PI:0,0],children:[i.jsx(ks,{onSwipeUp:r.onSwipeUp,onSwipeDown:r.onSwipeDown,onSwipeLeft:r.onSwipeLeft,onSwipeRight:r.onSwipeRight,onClick:r.onAreaClick,facingFactor:n.facingFactor,enabled:!t.isInteractionLocked}),i.jsx(re.group,{"position-x":n.xPos,children:s.map((o,a)=>i.jsx("group",{"position-x":_.calcPageOffsetX({pageIndex:a,pageWidth:n.pageWidth}),children:o.map((c,l)=>i.jsx(Bs,{card:c,index:l,player:e,isSelected:t.selectedCardId===c.instanceId,isAnySelected:t.isAnySelected,isVisible:t.effectiveIsVisible,onSelect:r.onCardSelect,onDeselect:r.onCardDeselect},c.instanceId))},a))})]})},Us={key:"card-hand",renderUI:e=>e==="main-3d"?i.jsxs(i.Fragment,{children:[i.jsx(Yt,{player:"alien"}),i.jsx(Yt,{player:"native"})]}):null},Hs={key:"play-card",init:()=>{const e=({cell:t})=>{const r=O.getState().selectedCardId;if(!r)return;const s=M.getState(),o=s.activePlayerId,a=s.playerStates[o],c=a.cardLibrary.find(u=>u.instanceId===r);if(!c)return;const l=q.find(u=>u.id===c.cardDefinitionId);if(!l)return;if(a.currentEnvironment<l.cost){console.warn(`[PlayCard] Not enough AP. Required: ${l.cost}, Current: ${a.currentEnvironment}`),$.ui.notify({message:"APãŒä¸è¶³ã—ã¦ã„ã¾ã™"});return}if(a.cooldownActiveCards.some(u=>u.cardId===r)){console.warn("[PlayCard] Card is on cooldown."),$.ui.notify({message:"ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ä¸­ã§ã™"});return}const d=cs(s,l,{x:t.x,y:t.y});if(d!==s){const u=[...a.cooldownActiveCards];l.cooldownTurns&&l.cooldownTurns>0&&u.push({cardId:r,roundsRemaining:l.cooldownTurns+1});const g={...a.limitedCardsUsedCount};if(l.usageLimit!==void 0){const E=g[l.id]||0;g[l.id]=E+1}const p={...d.playerStates[o],currentEnvironment:a.currentEnvironment-l.cost,cardLibrary:a.cardLibrary,cooldownActiveCards:u,limitedCardsUsedCount:g},h={...d,playerStates:{...d.playerStates,[o]:p}};$.system.updateState(h),$.ui.deselectCard(),console.info(`[PlayCard] Played ${l.name}. AP consumed: ${l.cost}`)}};return U.on("CELL_CLICK",e),()=>{U.off("CELL_CLICK",e)}},renderUI:()=>null},$s=e=>{const{alienInstances:t,currentRound:n}=e,r={...t};let s=!1,o=0;return console.group("[Feature: Alien Growth] Processing..."),Object.values(r).forEach(a=>{a.status==="seed"&&a.spawnedRound<=n&&(r[a.instanceId]={...a,status:"plant"},s=!0,o++,console.log(`[Growth] ðŸŒ± Seed (Spawned R${a.spawnedRound}) matured at the end of Round ${n}`))}),s?(console.info(`[Growth] ðŸŒ³ Total ${o} seeds matured.`),console.groupEnd(),{...e,alienInstances:r}):(console.log("[Growth] No seeds matured in this timing."),console.groupEnd(),e)},zs={key:"alien-growth",init:()=>{const e=()=>{const t=M.getState(),n=$s(t);n!==t&&$.system.updateState(n)};return U.on("ROUND_END",e),()=>U.off("ROUND_END",e)},renderUI:()=>null},Ys=e=>{const{alienInstances:t,gameField:n}=e,r=n.cells.map(a=>[...a]);let s=!1,o=0;return console.group("[Feature: Alien Expansion] Processing Chain Expansion..."),Object.values(t).forEach(a=>{if(a.status!=="plant")return;const c=Ws(a.cardDefinitionId);if(!c)return;const{range:l}=c,f=l.scale,d=l.shape,u=[];n.cells.forEach((g,p)=>{g.forEach((h,E)=>{h.alienUnitId===a.instanceId&&u.push({x:E,y:p})})}),u.forEach(g=>{Vs(n.width,n.height,g,d,f).forEach(h=>{const E=n.cells[h.y][h.x];if(Xs(E)){if(r[h.y][h.x].type==="alien"||r[h.y][h.x].type==="alien-core")return;const S={...E,type:"alien",ownerId:"alien",alienUnitId:a.instanceId};r[h.y][h.x]=S,s=!0,o++}})})}),s?(console.info(`[Expansion] ðŸŒŠ Chain expansion completed. Total ${o} cells invaded.`),console.groupEnd(),{...e,gameField:{...n,cells:r}}):(console.log("[Expansion] No new invasions occurred."),console.groupEnd(),e)},Xs=e=>{const t=e.type;return t==="native"||t==="pioneer"||t==="bare"},Ws=e=>q.find(t=>t.id===e&&t.cardType==="alien"),Vs=(e,t,n,r,s)=>{const o=[],{x:a,y:c}=n,l=(f,d)=>{f>=0&&f<e&&d>=0&&d<t&&o.push({x:f,y:d})};for(let f=1;f<=s;f++)switch(r){case"vertical":l(a,c-f),l(a,c+f);break;case"horizon":l(a-f,c),l(a+f,c);break;case"cross":l(a,c-f),l(a,c+f),l(a-f,c),l(a+f,c);break;case"x_cross":l(a-f,c-f),l(a+f,c-f),l(a-f,c+f),l(a+f,c+f);break;case"range":for(let d=-f;d<=f;d++)for(let u=-f;u<=f;u++)(Math.abs(u)===f||Math.abs(d)===f)&&l(a+u,c+d);break}return o},Zs={key:"alien-expansion",init:()=>{const e=()=>{const t=M.getState(),n=Ys(t);n!==t&&$.system.updateState(n)};return U.on("ROUND_END",e),()=>U.off("ROUND_END",e)},renderUI:()=>null};var z=function(){return z=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},z.apply(this,arguments)};function _e(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,o;r<s;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}var D="-ms-",we="-moz-",w="-webkit-",wn="comm",it="rule",Nt="decl",qs="@import",_n="@keyframes",Ks="@layer",Pn=Math.abs,Dt=String.fromCharCode,xt=Object.assign;function Qs(e,t){return G(e,0)^45?(((t<<2^G(e,0))<<2^G(e,1))<<2^G(e,2))<<2^G(e,3):0}function Nn(e){return e.trim()}function Q(e,t){return(e=t.exec(e))?e[0]:e}function A(e,t,n){return e.replace(t,n)}function Xe(e,t,n){return e.indexOf(t,n)}function G(e,t){return e.charCodeAt(t)|0}function me(e,t,n){return e.slice(t,n)}function Z(e){return e.length}function Dn(e){return e.length}function be(e,t){return t.push(e),e}function Js(e,t){return e.map(t).join("")}function Xt(e,t){return e.filter(function(n){return!Q(n,t)})}var at=1,Ee=1,Ln=0,W=0,F=0,Ce="";function ct(e,t,n,r,s,o,a,c){return{value:e,root:t,parent:n,type:r,props:s,children:o,line:at,column:Ee,length:a,return:"",siblings:c}}function ne(e,t){return xt(ct("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function fe(e){for(;e.root;)e=ne(e.root,{children:[e]});be(e,e.siblings)}function eo(){return F}function to(){return F=W>0?G(Ce,--W):0,Ee--,F===10&&(Ee=1,at--),F}function V(){return F=W<Ln?G(Ce,W++):0,Ee++,F===10&&(Ee=1,at++),F}function ce(){return G(Ce,W)}function We(){return W}function lt(e,t){return me(Ce,e,t)}function Ct(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function no(e){return at=Ee=1,Ln=Z(Ce=e),W=0,[]}function ro(e){return Ce="",e}function mt(e){return Nn(lt(W-1,At(e===91?e+2:e===40?e+1:e)))}function so(e){for(;(F=ce())&&F<33;)V();return Ct(e)>2||Ct(F)>3?"":" "}function oo(e,t){for(;--t&&V()&&!(F<48||F>102||F>57&&F<65||F>70&&F<97););return lt(e,We()+(t<6&&ce()==32&&V()==32))}function At(e){for(;V();)switch(F){case e:return W;case 34:case 39:e!==34&&e!==39&&At(F);break;case 40:e===41&&At(e);break;case 92:V();break}return W}function io(e,t){for(;V()&&e+F!==57;)if(e+F===84&&ce()===47)break;return"/*"+lt(t,W-1)+"*"+Dt(e===47?e:V())}function ao(e){for(;!Ct(ce());)V();return lt(e,W)}function co(e){return ro(Ve("",null,null,null,[""],e=no(e),0,[0],e))}function Ve(e,t,n,r,s,o,a,c,l){for(var f=0,d=0,u=a,g=0,p=0,h=0,E=1,S=1,T=1,x=0,C="",I=s,b=o,v=r,R=C;S;)switch(h=x,x=V()){case 40:if(h!=108&&G(R,u-1)==58){Xe(R+=A(mt(x),"&","&\f"),"&\f",Pn(f?c[f-1]:0))!=-1&&(T=-1);break}case 34:case 39:case 91:R+=mt(x);break;case 9:case 10:case 13:case 32:R+=so(h);break;case 92:R+=oo(We()-1,7);continue;case 47:switch(ce()){case 42:case 47:be(lo(io(V(),We()),t,n,l),l);break;default:R+="/"}break;case 123*E:c[f++]=Z(R)*T;case 125*E:case 59:case 0:switch(x){case 0:case 125:S=0;case 59+d:T==-1&&(R=A(R,/\f/g,"")),p>0&&Z(R)-u&&be(p>32?Vt(R+";",r,n,u-1,l):Vt(A(R," ","")+";",r,n,u-2,l),l);break;case 59:R+=";";default:if(be(v=Wt(R,t,n,f,d,s,c,C,I=[],b=[],u,o),o),x===123)if(d===0)Ve(R,t,v,v,I,o,u,c,b);else switch(g===99&&G(R,3)===110?100:g){case 100:case 108:case 109:case 115:Ve(e,v,v,r&&be(Wt(e,v,v,0,0,s,c,C,s,I=[],u,b),b),s,b,u,c,r?I:b);break;default:Ve(R,v,v,v,[""],b,0,c,b)}}f=d=p=0,E=T=1,C=R="",u=a;break;case 58:u=1+Z(R),p=h;default:if(E<1){if(x==123)--E;else if(x==125&&E++==0&&to()==125)continue}switch(R+=Dt(x),x*E){case 38:T=d>0?1:(R+="\f",-1);break;case 44:c[f++]=(Z(R)-1)*T,T=1;break;case 64:ce()===45&&(R+=mt(V())),g=ce(),d=u=Z(C=R+=ao(We())),x++;break;case 45:h===45&&Z(R)==2&&(E=0)}}return o}function Wt(e,t,n,r,s,o,a,c,l,f,d,u){for(var g=s-1,p=s===0?o:[""],h=Dn(p),E=0,S=0,T=0;E<r;++E)for(var x=0,C=me(e,g+1,g=Pn(S=a[E])),I=e;x<h;++x)(I=Nn(S>0?p[x]+" "+C:A(C,/&\f/g,p[x])))&&(l[T++]=I);return ct(e,t,n,s===0?it:c,l,f,d,u)}function lo(e,t,n,r){return ct(e,t,n,wn,Dt(eo()),me(e,2,-2),0,r)}function Vt(e,t,n,r,s){return ct(e,t,n,Nt,me(e,0,r),me(e,r+1,-1),r,s)}function jn(e,t,n){switch(Qs(e,t)){case 5103:return w+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return w+e+e;case 4789:return we+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return w+e+we+e+D+e+e;case 5936:switch(G(e,t+11)){case 114:return w+e+D+A(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return w+e+D+A(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return w+e+D+A(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return w+e+D+e+e;case 6165:return w+e+D+"flex-"+e+e;case 5187:return w+e+A(e,/(\w+).+(:[^]+)/,w+"box-$1$2"+D+"flex-$1$2")+e;case 5443:return w+e+D+"flex-item-"+A(e,/flex-|-self/g,"")+(Q(e,/flex-|baseline/)?"":D+"grid-row-"+A(e,/flex-|-self/g,""))+e;case 4675:return w+e+D+"flex-line-pack"+A(e,/align-content|flex-|-self/g,"")+e;case 5548:return w+e+D+A(e,"shrink","negative")+e;case 5292:return w+e+D+A(e,"basis","preferred-size")+e;case 6060:return w+"box-"+A(e,"-grow","")+w+e+D+A(e,"grow","positive")+e;case 4554:return w+A(e,/([^-])(transform)/g,"$1"+w+"$2")+e;case 6187:return A(A(A(e,/(zoom-|grab)/,w+"$1"),/(image-set)/,w+"$1"),e,"")+e;case 5495:case 3959:return A(e,/(image-set\([^]*)/,w+"$1$`$1");case 4968:return A(A(e,/(.+:)(flex-)?(.*)/,w+"box-pack:$3"+D+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+w+e+e;case 4200:if(!Q(e,/flex-|baseline/))return D+"grid-column-align"+me(e,t)+e;break;case 2592:case 3360:return D+A(e,"template-","")+e;case 4384:case 3616:return n&&n.some(function(r,s){return t=s,Q(r.props,/grid-\w+-end/)})?~Xe(e+(n=n[t].value),"span",0)?e:D+A(e,"-start","")+e+D+"grid-row-span:"+(~Xe(n,"span",0)?Q(n,/\d+/):+Q(n,/\d+/)-+Q(e,/\d+/))+";":D+A(e,"-start","")+e;case 4896:case 4128:return n&&n.some(function(r){return Q(r.props,/grid-\w+-start/)})?e:D+A(A(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return A(e,/(.+)-inline(.+)/,w+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Z(e)-1-t>6)switch(G(e,t+1)){case 109:if(G(e,t+4)!==45)break;case 102:return A(e,/(.+:)(.+)-([^]+)/,"$1"+w+"$2-$3$1"+we+(G(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~Xe(e,"stretch",0)?jn(A(e,"stretch","fill-available"),t,n)+e:e}break;case 5152:case 5920:return A(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,s,o,a,c,l,f){return D+s+":"+o+f+(a?D+s+"-span:"+(c?l:+l-+o)+f:"")+e});case 4949:if(G(e,t+6)===121)return A(e,":",":"+w)+e;break;case 6444:switch(G(e,G(e,14)===45?18:11)){case 120:return A(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+w+(G(e,14)===45?"inline-":"")+"box$3$1"+w+"$2$3$1"+D+"$2box$3")+e;case 100:return A(e,":",":"+D)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return A(e,"scroll-","scroll-snap-")+e}return e}function Je(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function uo(e,t,n,r){switch(e.type){case Ks:if(e.children.length)break;case qs:case Nt:return e.return=e.return||e.value;case wn:return"";case _n:return e.return=e.value+"{"+Je(e.children,r)+"}";case it:if(!Z(e.value=e.props.join(",")))return""}return Z(n=Je(e.children,r))?e.return=e.value+"{"+n+"}":""}function po(e){var t=Dn(e);return function(n,r,s,o){for(var a="",c=0;c<t;c++)a+=e[c](n,r,s,o)||"";return a}}function fo(e){return function(t){t.root||(t=t.return)&&e(t)}}function ho(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case Nt:e.return=jn(e.value,e.length,n);return;case _n:return Je([ne(e,{value:A(e.value,"@","@"+w)})],r);case it:if(e.length)return Js(n=e.props,function(s){switch(Q(s,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":fe(ne(e,{props:[A(s,/:(read-\w+)/,":"+we+"$1")]})),fe(ne(e,{props:[s]})),xt(e,{props:Xt(n,r)});break;case"::placeholder":fe(ne(e,{props:[A(s,/:(plac\w+)/,":"+w+"input-$1")]})),fe(ne(e,{props:[A(s,/:(plac\w+)/,":"+we+"$1")]})),fe(ne(e,{props:[A(s,/:(plac\w+)/,D+"input-$1")]})),fe(ne(e,{props:[s]})),xt(e,{props:Xt(n,r)});break}return""})}}var go={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Y={},ye=typeof process<"u"&&Y!==void 0&&(Y.REACT_APP_SC_ATTR||Y.SC_ATTR)||"data-styled",Fn="active",Mn="data-styled-version",dt="6.1.19",Lt=`/*!sc*/
`,et=typeof window<"u"&&typeof document<"u",mo=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Y!==void 0&&Y.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Y.REACT_APP_SC_DISABLE_SPEEDY!==""?Y.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Y.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&Y!==void 0&&Y.SC_DISABLE_SPEEDY!==void 0&&Y.SC_DISABLE_SPEEDY!==""&&Y.SC_DISABLE_SPEEDY!=="false"&&Y.SC_DISABLE_SPEEDY),ut=Object.freeze([]),Se=Object.freeze({});function Eo(e,t,n){return n===void 0&&(n=Se),e.theme!==n.theme&&e.theme||t||n.theme}var Gn=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),yo=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,So=/(^-|-$)/g;function Zt(e){return e.replace(yo,"-").replace(So,"")}var Io=/(a)(d)/gi,$e=52,qt=function(e){return String.fromCharCode(e+(e>25?39:97))};function Rt(e){var t,n="";for(t=Math.abs(e);t>$e;t=t/$e|0)n=qt(t%$e)+n;return(qt(t%$e)+n).replace(Io,"$1-$2")}var Et,kn=5381,he=function(e,t){for(var n=t.length;n;)e=33*e^t.charCodeAt(--n);return e},Bn=function(e){return he(kn,e)};function Un(e){return Rt(Bn(e)>>>0)}function To(e){return e.displayName||e.name||"Component"}function yt(e){return typeof e=="string"&&!0}var Hn=typeof Symbol=="function"&&Symbol.for,$n=Hn?Symbol.for("react.memo"):60115,xo=Hn?Symbol.for("react.forward_ref"):60112,Co={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Ao={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},zn={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Ro=((Et={})[xo]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Et[$n]=zn,Et);function Kt(e){return("type"in(t=e)&&t.type.$$typeof)===$n?zn:"$$typeof"in e?Ro[e.$$typeof]:Co;var t}var vo=Object.defineProperty,Oo=Object.getOwnPropertyNames,Qt=Object.getOwnPropertySymbols,bo=Object.getOwnPropertyDescriptor,wo=Object.getPrototypeOf,Jt=Object.prototype;function Yn(e,t,n){if(typeof t!="string"){if(Jt){var r=wo(t);r&&r!==Jt&&Yn(e,r,n)}var s=Oo(t);Qt&&(s=s.concat(Qt(t)));for(var o=Kt(e),a=Kt(t),c=0;c<s.length;++c){var l=s[c];if(!(l in Ao||n&&n[l]||a&&l in a||o&&l in o)){var f=bo(t,l);try{vo(e,l,f)}catch{}}}}return e}function Ie(e){return typeof e=="function"}function jt(e){return typeof e=="object"&&"styledComponentId"in e}function ae(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function vt(e,t){if(e.length===0)return"";for(var n=e[0],r=1;r<e.length;r++)n+=e[r];return n}function Pe(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function Ot(e,t,n){if(n===void 0&&(n=!1),!n&&!Pe(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var r=0;r<t.length;r++)e[r]=Ot(e[r],t[r]);else if(Pe(t))for(var r in t)e[r]=Ot(e[r],t[r]);return e}function Ft(e,t){Object.defineProperty(e,"toString",{value:t})}function je(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var _o=(function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var n=0,r=0;r<t;r++)n+=this.groupSizes[r];return n},e.prototype.insertRules=function(t,n){if(t>=this.groupSizes.length){for(var r=this.groupSizes,s=r.length,o=s;t>=o;)if((o<<=1)<0)throw je(16,"".concat(t));this.groupSizes=new Uint32Array(o),this.groupSizes.set(r),this.length=o;for(var a=s;a<o;a++)this.groupSizes[a]=0}for(var c=this.indexOfGroup(t+1),l=(a=0,n.length);a<l;a++)this.tag.insertRule(c,n[a])&&(this.groupSizes[t]++,c++)},e.prototype.clearGroup=function(t){if(t<this.length){var n=this.groupSizes[t],r=this.indexOfGroup(t),s=r+n;this.groupSizes[t]=0;for(var o=r;o<s;o++)this.tag.deleteRule(r)}},e.prototype.getGroup=function(t){var n="";if(t>=this.length||this.groupSizes[t]===0)return n;for(var r=this.groupSizes[t],s=this.indexOfGroup(t),o=s+r,a=s;a<o;a++)n+="".concat(this.tag.getRule(a)).concat(Lt);return n},e})(),Ze=new Map,tt=new Map,qe=1,ze=function(e){if(Ze.has(e))return Ze.get(e);for(;tt.has(qe);)qe++;var t=qe++;return Ze.set(e,t),tt.set(t,e),t},Po=function(e,t){qe=t+1,Ze.set(e,t),tt.set(t,e)},No="style[".concat(ye,"][").concat(Mn,'="').concat(dt,'"]'),Do=new RegExp("^".concat(ye,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),Lo=function(e,t,n){for(var r,s=n.split(","),o=0,a=s.length;o<a;o++)(r=s[o])&&e.registerName(t,r)},jo=function(e,t){for(var n,r=((n=t.textContent)!==null&&n!==void 0?n:"").split(Lt),s=[],o=0,a=r.length;o<a;o++){var c=r[o].trim();if(c){var l=c.match(Do);if(l){var f=0|parseInt(l[1],10),d=l[2];f!==0&&(Po(d,f),Lo(e,d,l[3]),e.getTag().insertRules(f,s)),s.length=0}else s.push(c)}}},en=function(e){for(var t=document.querySelectorAll(No),n=0,r=t.length;n<r;n++){var s=t[n];s&&s.getAttribute(ye)!==Fn&&(jo(e,s),s.parentNode&&s.parentNode.removeChild(s))}};function Fo(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var Xn=function(e){var t=document.head,n=e||t,r=document.createElement("style"),s=(function(c){var l=Array.from(c.querySelectorAll("style[".concat(ye,"]")));return l[l.length-1]})(n),o=s!==void 0?s.nextSibling:null;r.setAttribute(ye,Fn),r.setAttribute(Mn,dt);var a=Fo();return a&&r.setAttribute("nonce",a),n.insertBefore(r,o),r},Mo=(function(){function e(t){this.element=Xn(t),this.element.appendChild(document.createTextNode("")),this.sheet=(function(n){if(n.sheet)return n.sheet;for(var r=document.styleSheets,s=0,o=r.length;s<o;s++){var a=r[s];if(a.ownerNode===n)return a}throw je(17)})(this.element),this.length=0}return e.prototype.insertRule=function(t,n){try{return this.sheet.insertRule(n,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var n=this.sheet.cssRules[t];return n&&n.cssText?n.cssText:""},e})(),Go=(function(){function e(t){this.element=Xn(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,n){if(t<=this.length&&t>=0){var r=document.createTextNode(n);return this.element.insertBefore(r,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e})(),ko=(function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,n){return t<=this.length&&(this.rules.splice(t,0,n),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e})(),tn=et,Bo={isServer:!et,useCSSOMInjection:!mo},Wn=(function(){function e(t,n,r){t===void 0&&(t=Se),n===void 0&&(n={});var s=this;this.options=z(z({},Bo),t),this.gs=n,this.names=new Map(r),this.server=!!t.isServer,!this.server&&et&&tn&&(tn=!1,en(this)),Ft(this,function(){return(function(o){for(var a=o.getTag(),c=a.length,l="",f=function(u){var g=(function(T){return tt.get(T)})(u);if(g===void 0)return"continue";var p=o.names.get(g),h=a.getGroup(u);if(p===void 0||!p.size||h.length===0)return"continue";var E="".concat(ye,".g").concat(u,'[id="').concat(g,'"]'),S="";p!==void 0&&p.forEach(function(T){T.length>0&&(S+="".concat(T,","))}),l+="".concat(h).concat(E,'{content:"').concat(S,'"}').concat(Lt)},d=0;d<c;d++)f(d);return l})(s)})}return e.registerId=function(t){return ze(t)},e.prototype.rehydrate=function(){!this.server&&et&&en(this)},e.prototype.reconstructWithOptions=function(t,n){return n===void 0&&(n=!0),new e(z(z({},this.options),t),this.gs,n&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=(function(n){var r=n.useCSSOMInjection,s=n.target;return n.isServer?new ko(s):r?new Mo(s):new Go(s)})(this.options),new _o(t)));var t},e.prototype.hasNameForId=function(t,n){return this.names.has(t)&&this.names.get(t).has(n)},e.prototype.registerName=function(t,n){if(ze(t),this.names.has(t))this.names.get(t).add(n);else{var r=new Set;r.add(n),this.names.set(t,r)}},e.prototype.insertRules=function(t,n,r){this.registerName(t,n),this.getTag().insertRules(ze(t),r)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(ze(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e})(),Uo=/&/g,Ho=/^\s*\/\/.*$/gm;function Vn(e,t){return e.map(function(n){return n.type==="rule"&&(n.value="".concat(t," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(t," ")),n.props=n.props.map(function(r){return"".concat(t," ").concat(r)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=Vn(n.children,t)),n})}function $o(e){var t,n,r,s=Se,o=s.options,a=o===void 0?Se:o,c=s.plugins,l=c===void 0?ut:c,f=function(g,p,h){return h.startsWith(n)&&h.endsWith(n)&&h.replaceAll(n,"").length>0?".".concat(t):g},d=l.slice();d.push(function(g){g.type===it&&g.value.includes("&")&&(g.props[0]=g.props[0].replace(Uo,n).replace(r,f))}),a.prefix&&d.push(ho),d.push(uo);var u=function(g,p,h,E){p===void 0&&(p=""),h===void 0&&(h=""),E===void 0&&(E="&"),t=E,n=p,r=new RegExp("\\".concat(n,"\\b"),"g");var S=g.replace(Ho,""),T=co(h||p?"".concat(h," ").concat(p," { ").concat(S," }"):S);a.namespace&&(T=Vn(T,a.namespace));var x=[];return Je(T,po(d.concat(fo(function(C){return x.push(C)})))),x};return u.hash=l.length?l.reduce(function(g,p){return p.name||je(15),he(g,p.name)},kn).toString():"",u}var zo=new Wn,bt=$o(),Zn=de.createContext({shouldForwardProp:void 0,styleSheet:zo,stylis:bt});Zn.Consumer;de.createContext(void 0);function nn(){return y.useContext(Zn)}var qn=(function(){function e(t,n){var r=this;this.inject=function(s,o){o===void 0&&(o=bt);var a=r.name+o.hash;s.hasNameForId(r.id,a)||s.insertRules(r.id,a,o(r.rules,a,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=n,Ft(this,function(){throw je(12,String(r.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=bt),this.name+t.hash},e})(),Yo=function(e){return e>="A"&&e<="Z"};function rn(e){for(var t="",n=0;n<e.length;n++){var r=e[n];if(n===1&&r==="-"&&e[0]==="-")return e;Yo(r)?t+="-"+r.toLowerCase():t+=r}return t.startsWith("ms-")?"-"+t:t}var Kn=function(e){return e==null||e===!1||e===""},Qn=function(e){var t,n,r=[];for(var s in e){var o=e[s];e.hasOwnProperty(s)&&!Kn(o)&&(Array.isArray(o)&&o.isCss||Ie(o)?r.push("".concat(rn(s),":"),o,";"):Pe(o)?r.push.apply(r,_e(_e(["".concat(s," {")],Qn(o),!1),["}"],!1)):r.push("".concat(rn(s),": ").concat((t=s,(n=o)==null||typeof n=="boolean"||n===""?"":typeof n!="number"||n===0||t in go||t.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return r};function le(e,t,n,r){if(Kn(e))return[];if(jt(e))return[".".concat(e.styledComponentId)];if(Ie(e)){if(!Ie(o=e)||o.prototype&&o.prototype.isReactComponent||!t)return[e];var s=e(t);return le(s,t,n,r)}var o;return e instanceof qn?n?(e.inject(n,r),[e.getName(r)]):[e]:Pe(e)?Qn(e):Array.isArray(e)?Array.prototype.concat.apply(ut,e.map(function(a){return le(a,t,n,r)})):[e.toString()]}function Xo(e){for(var t=0;t<e.length;t+=1){var n=e[t];if(Ie(n)&&!jt(n))return!1}return!0}var Wo=Bn(dt),Vo=(function(){function e(t,n,r){this.rules=t,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&Xo(t),this.componentId=n,this.baseHash=he(Wo,n),this.baseStyle=r,Wn.registerId(n)}return e.prototype.generateAndInjectStyles=function(t,n,r){var s=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,n,r):"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))s=ae(s,this.staticRulesId);else{var o=vt(le(this.rules,t,n,r)),a=Rt(he(this.baseHash,o)>>>0);if(!n.hasNameForId(this.componentId,a)){var c=r(o,".".concat(a),void 0,this.componentId);n.insertRules(this.componentId,a,c)}s=ae(s,a),this.staticRulesId=a}else{for(var l=he(this.baseHash,r.hash),f="",d=0;d<this.rules.length;d++){var u=this.rules[d];if(typeof u=="string")f+=u;else if(u){var g=vt(le(u,t,n,r));l=he(l,g+d),f+=g}}if(f){var p=Rt(l>>>0);n.hasNameForId(this.componentId,p)||n.insertRules(this.componentId,p,r(f,".".concat(p),void 0,this.componentId)),s=ae(s,p)}}return s},e})(),Jn=de.createContext(void 0);Jn.Consumer;var St={};function Zo(e,t,n){var r=jt(e),s=e,o=!yt(e),a=t.attrs,c=a===void 0?ut:a,l=t.componentId,f=l===void 0?(function(I,b){var v=typeof I!="string"?"sc":Zt(I);St[v]=(St[v]||0)+1;var R="".concat(v,"-").concat(Un(dt+v+St[v]));return b?"".concat(b,"-").concat(R):R})(t.displayName,t.parentComponentId):l,d=t.displayName,u=d===void 0?(function(I){return yt(I)?"styled.".concat(I):"Styled(".concat(To(I),")")})(e):d,g=t.displayName&&t.componentId?"".concat(Zt(t.displayName),"-").concat(t.componentId):t.componentId||f,p=r&&s.attrs?s.attrs.concat(c).filter(Boolean):c,h=t.shouldForwardProp;if(r&&s.shouldForwardProp){var E=s.shouldForwardProp;if(t.shouldForwardProp){var S=t.shouldForwardProp;h=function(I,b){return E(I,b)&&S(I,b)}}else h=E}var T=new Vo(n,g,r?s.componentStyle:void 0);function x(I,b){return(function(v,R,pe){var Me=v.attrs,tr=v.componentStyle,nr=v.defaultProps,rr=v.foldedComponentIds,sr=v.styledComponentId,or=v.target,ir=de.useContext(Jn),ar=nn(),pt=v.shouldForwardProp||ar.shouldForwardProp,Gt=Eo(R,ir,nr)||Se,K=(function(ke,Re,Be){for(var ve,se=z(z({},Re),{className:void 0,theme:Be}),ht=0;ht<ke.length;ht+=1){var Ue=Ie(ve=ke[ht])?ve(se):ve;for(var te in Ue)se[te]=te==="className"?ae(se[te],Ue[te]):te==="style"?z(z({},se[te]),Ue[te]):Ue[te]}return Re.className&&(se.className=ae(se.className,Re.className)),se})(Me,R,Gt),Ge=K.as||or,Ae={};for(var ee in K)K[ee]===void 0||ee[0]==="$"||ee==="as"||ee==="theme"&&K.theme===Gt||(ee==="forwardedAs"?Ae.as=K.forwardedAs:pt&&!pt(ee,Ge)||(Ae[ee]=K[ee]));var kt=(function(ke,Re){var Be=nn(),ve=ke.generateAndInjectStyles(Re,Be.styleSheet,Be.stylis);return ve})(tr,K),ft=ae(rr,sr);return kt&&(ft+=" "+kt),K.className&&(ft+=" "+K.className),Ae[yt(Ge)&&!Gn.has(Ge)?"class":"className"]=ft,pe&&(Ae.ref=pe),y.createElement(Ge,Ae)})(C,I,b)}x.displayName=u;var C=de.forwardRef(x);return C.attrs=p,C.componentStyle=T,C.displayName=u,C.shouldForwardProp=h,C.foldedComponentIds=r?ae(s.foldedComponentIds,s.styledComponentId):"",C.styledComponentId=g,C.target=r?s.target:e,Object.defineProperty(C,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(I){this._foldedDefaultProps=r?(function(b){for(var v=[],R=1;R<arguments.length;R++)v[R-1]=arguments[R];for(var pe=0,Me=v;pe<Me.length;pe++)Ot(b,Me[pe],!0);return b})({},s.defaultProps,I):I}}),Ft(C,function(){return".".concat(C.styledComponentId)}),o&&Yn(C,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),C}function sn(e,t){for(var n=[e[0]],r=0,s=t.length;r<s;r+=1)n.push(t[r],e[r+1]);return n}var on=function(e){return Object.assign(e,{isCss:!0})};function X(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Ie(e)||Pe(e))return on(le(sn(ut,_e([e],t,!0))));var r=e;return t.length===0&&r.length===1&&typeof r[0]=="string"?le(r):on(le(sn(r,t)))}function wt(e,t,n){if(n===void 0&&(n=Se),!t)throw je(1,t);var r=function(s){for(var o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];return e(t,n,X.apply(void 0,_e([s],o,!1)))};return r.attrs=function(s){return wt(e,t,z(z({},n),{attrs:Array.prototype.concat(n.attrs,s).filter(Boolean)}))},r.withConfig=function(s){return wt(e,t,z(z({},n),s))},r}var er=function(e){return wt(Zo,e)},P=er;Gn.forEach(function(e){P[e]=er(e)});function Fe(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=vt(X.apply(void 0,_e([e],t,!1))),s=Un(r);return new qn(s,r)}const Ye={WIDTH_OPEN:"260px",WIDTH_CLOSED:"80px",OFFSET:"0px"},qo="240px",Ko=P.div`
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  width: ${({$isOpen:e})=>e?Ye.WIDTH_OPEN:Ye.WIDTH_CLOSED};
  height: auto;
  min-height: 200px;
  z-index: 100;
  pointer-events: none; /* ã‚³ãƒ³ãƒ†ãƒŠè‡ªä½“ã¯é€éŽ */
  transition: width 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);

  ${({$position:e})=>e==="left"?X`
          left: ${Ye.OFFSET};
          /* å·¦å´ï¼ˆNative/å¾Œæ”»ï¼‰ã¯å¯¾é¢ç”¨ã«180åº¦å›žè»¢ */
          .content-rotator {
            transform: rotate(180deg);
          }
        `:X`
          right: ${Ye.OFFSET};
        `}
`,Qo=P.div`
  pointer-events: auto;
  /* âœ¨ ä¿®æ­£: backdrop-filterã‚’å»ƒæ­¢ã—ã€ä¸é€æ˜Žåº¦ã‚’ä¸Šã’ã¦è¦–èªæ€§ã‚’ç¢ºä¿ (0.85 -> 0.95) */
  background: rgba(20, 20, 20, 0.95);
  /* backdrop-filter: blur(12px); <-- GPUè² è·è»½æ¸›ã®ãŸã‚å‰Šé™¤ */

  /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒœãƒ¼ãƒ€ãƒ¼ã¾ãŸã¯ã‚¢ã‚¯ãƒ†ã‚£ãƒ–æ™‚ã®ãƒœãƒ¼ãƒ€ãƒ¼ */
  border: 1px solid
    ${({$isActive:e,$accentColor:t})=>e&&t?t:"rgba(255, 255, 255, 0.1)"};

  border-radius: ${({$position:e})=>e==="left"?"0 12px 12px 0":"12px 0 0 12px"};
  padding: 10px;
  display: flex;
  flex-direction: column;
  gap: 10px;

  /* ã‚¢ã‚¯ãƒ†ã‚£ãƒ–æ™‚ã¯ç™ºå…‰åŠ¹æžœã‚’è¿½åŠ ã€éžã‚¢ã‚¯ãƒ†ã‚£ãƒ–æ™‚ã¯é€šå¸¸ã®å½±ã®ã¿ */
  box-shadow: ${({$isActive:e,$accentColor:t})=>e&&t?`0 0 15px ${t}66, 0 8px 32px rgba(0, 0, 0, 0.5)`:"0 8px 32px rgba(0, 0, 0, 0.5)"};

  overflow: hidden;
  transition: all 0.3s ease;

  /* é–‰ã˜ãŸã¨ãã®ä¸­èº«ã®åˆ¶å¾¡ */
  ${({$isOpen:e})=>!e&&X`
      align-items: center;
      padding: 15px 5px;
    `}
`,Jo=P.div`
  width: 100%;
  /* é–‹ã„ã¦ã„ã‚‹æ™‚ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠãŒä¼¸ã³ã¦ã„ã‚‹é€”ä¸­ã§ã‚‚ä¸­èº«ã®å¹…ã‚’ç¢ºä¿ã™ã‚‹ */
  ${({$isOpen:e})=>e&&X`
      min-width: ${qo};
    `}
`,ei=P.button`
  background: transparent;
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: #aaa;
  cursor: pointer;
  padding: 4px;
  border-radius: 4px;
  width: 100%;
  margin-bottom: 8px;
  font-size: 10px;
  text-transform: uppercase;
  transition: all 0.2s;

  &:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
  }
`,an=({position:e,isActive:t,accentColor:n,children:r})=>{const[s,o]=y.useState(!1);return i.jsx(Ko,{$position:e,$isOpen:s,children:i.jsx("div",{className:"content-rotator",style:{width:"100%",height:"100%"},children:i.jsxs(Qo,{$position:e,$isOpen:s,$isActive:t,$accentColor:n,children:[i.jsx(ei,{onClick:()=>o(!s),children:s?e==="left"?"< CLOSE":"CLOSE >":e==="left"?"MENU >":"< MENU"}),i.jsx(Jo,{$isOpen:s,children:r(s)})]})})})},Mt=P.button`
  flex-grow: 1;
  color: white;
  border: none;
  border-radius: 12px;
  padding: 12px 10px;
  font-size: 1.2em;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
  transition: all 0.2s ease-in-out;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
  width: 100%;

  &:hover:not(:disabled) {
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    transform: translateY(-2px);
  }

  &:active:not(:disabled) {
    transform: translateY(1px) scale(0.98);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
  }

  &:disabled {
    background: #757575;
    color: #bdbdbd;
    cursor: not-allowed;
    box-shadow: none;
    transform: none;
    opacity: 0.7;
  }
`;P.div`
  display: flex;
  flex-direction: column;
  gap: 10px;
  width: 100%;
`;const cn=P.div`
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 12px;
  color: white;
  font-family: "Inter", sans-serif;
`,ti=P.div`
  display: flex;
  justify-content: space-between;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  padding-bottom: 8px;

  .name {
    font-weight: 800;
    font-size: ${({$compact:e})=>e?"0.9rem":"1.15rem"};
    color: ${({$color:e})=>e};
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
`,ni=P.div`
  display: flex;
  flex-direction: column;
  align-items: flex-end;

  .current-score {
    font-family: "Fira Code", monospace;
    font-size: 1.2rem;
    font-weight: bold;
    color: white;
  }

  .opponent-score {
    font-family: "Fira Code", monospace;
    font-size: 0.8rem;
    color: #999;
    margin-top: 2px;
  }
`,ri=P.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 0.85rem;
  color: #ccc;
`,si=P.div`
  width: 100%;
  height: 6px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 3px;
  margin-top: 4px;
  overflow: hidden;
`,oi=P.div`
  height: 100%;
  width: ${({$percent:e})=>e}%;
  background: ${({$color:e})=>e};
  transition: width 0.5s ease-out;
`,ii=P.div`
  display: flex;
  flex-direction: column;
  gap: 2px;
  width: 100%;
`,ln=P(Mt)`
  font-size: 0.9rem;
  padding: 10px;
  margin-top: 5px;
  background: ${({$isActive:e,$themeColor:t})=>e?t:"#333"};
  border: ${({$isActive:e,$themeColor:t})=>e?`1px solid ${t}`:"1px solid #555"};

  ${({$isActive:e})=>!e&&X`
      opacity: 0.5;
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    `}
`,dn=({playerId:e,isOpen:t})=>{const n=N.usePlayer(e),r=N.useScore(e),s=e==="alien"?"native":"alien",o=N.useScore(s),a=s==="alien"?"å¤–æ¥ç¨®":"åœ¨æ¥ç¨®",c=N.useActivePlayer(),l=N.useCurrentRound(),f=c===e,d=e==="alien"?"#E57373":"#66BB6A";if(!n)return null;const u=n.currentEnvironment/n.maxEnvironment*100,g=()=>{if(!f){$.ui.notify({message:"ç›¸æ‰‹ã®ã‚¿ãƒ¼ãƒ³ã§ã™",type:"error"});return}$.turn.end()},p=i.jsxs(ii,{children:[i.jsxs(ri,{children:[i.jsx("span",{style:{fontSize:t?"0.85rem":"0.7rem"},children:t?"ã‚¨ãƒ³ãƒã‚¤ãƒ­ãƒ¡ãƒ³ãƒˆ (AP)":"AP"}),i.jsxs("span",{style:{fontWeight:"bold",color:"white",fontSize:t?"0.85rem":"0.75rem"},children:[n.currentEnvironment," / ",n.maxEnvironment]})]}),i.jsx(si,{children:i.jsx(oi,{$percent:u,$color:d})})]});return t?i.jsxs(cn,{children:[i.jsxs(ti,{$color:d,$compact:!1,children:[i.jsx("div",{className:"name",children:n.playerName}),i.jsxs(ni,{children:[i.jsxs("div",{className:"current-score",children:[r," ç‚¹"]}),i.jsxs("div",{className:"opponent-score",children:[a,": ",o," ç‚¹"]})]})]}),p,i.jsx(ln,{$isActive:f,$themeColor:d,onClick:g,disabled:!f,children:f?`ã‚¿ãƒ¼ãƒ³çµ‚äº† (R${l})`:"ç›¸æ‰‹ã®ã‚¿ãƒ¼ãƒ³ä¸­..."})]}):i.jsxs(cn,{children:[i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"0.7rem",color:d,fontWeight:"bold",marginBottom:"4px"},children:e==="alien"?"å¤–æ¥ç¨®":"åœ¨æ¥ç¨®"}),i.jsxs("div",{style:{fontSize:"1.2rem",fontWeight:"bold",marginBottom:"8px"},children:[r," ç‚¹"]})]}),p,f&&i.jsx(ln,{$isActive:!0,$themeColor:d,onClick:g,style:{padding:"6px",fontSize:"0.7rem",marginTop:"8px"},children:"çµ‚äº†"})]})},ai=()=>{const{isGameOver:e}=N.useGameState(),t=N.useCurrentRound(),n=N.useActivePlayer(),r="#66BB6A",s="#E57373";return t===0||e?null:i.jsxs(i.Fragment,{children:[i.jsx(an,{position:"left",isActive:n==="native",accentColor:r,children:o=>i.jsx(dn,{playerId:"native",isOpen:o})}),i.jsx(an,{position:"right",isActive:n==="alien",accentColor:s,children:o=>i.jsx(dn,{playerId:"alien",isOpen:o})})]})},ci={key:"info-hud",renderUI:e=>e==="ui-overlay"?i.jsx(ai,{}):null},li=3e3,di=3e3,ui=Fe`
  from { transform: translateY(20px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
`,pi=Fe`
  from { opacity: 1; }
  to { opacity: 0; }
`,fi=P.div`
  position: absolute;
  /* bottomåŸºæº–ã ã¨ä¸Šã«ä¼¸ã³ã¦ã—ã¾ã†ãŸã‚ã€topåŸºæº–ã«å¤‰æ›´ */
  top: calc(100vh - (100vh / 2.1));
  left: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  z-index: 2000;
  pointer-events: none;
  /* å›žè»¢ãªã— */
`,hi=P.div`
  position: absolute;
  top: calc(100vh / 2.1);
  right: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  z-index: 2000;
  pointer-events: none;

  /* 180åº¦å›žè»¢ï¼ˆå¯¾é¢è¡¨ç¤ºï¼‰ */
  transform: rotate(180deg);
  /* âœ¨ é‡è¦: å›žè»¢ã®ä¸­å¿ƒã‚’ã€Œä¸Šè¾ºã€ã«ã™ã‚‹ã“ã¨ã§ã€é«˜ã•ãŒå¤‰ã‚ã£ã¦ã‚‚é–‹å§‹ä½ç½®ã‚’å›ºå®šã™ã‚‹ */
  transform-origin: center top;
`,gi=P.div`
  /* ã‚¿ã‚¤ãƒ—åˆ¥èƒŒæ™¯è‰² */
  background: ${({$type:e})=>{switch(e){case"error":return"rgba(211, 47, 47, 0.95)";case"success":return"rgba(56, 142, 60, 0.95)";case"system":return"rgba(255, 193, 7, 0.95)";default:return"rgba(25, 118, 210, 0.95)"}}};

  /* ã‚·ã‚¹ãƒ†ãƒ é€šçŸ¥ã®å ´åˆã¯æ–‡å­—è‰²ã‚’é»’ã«ã€ãã‚Œä»¥å¤–ã¯ç™½ */
  color: ${({$type:e})=>e==="system"?"#3e3e3eff":"#fff"};

  /* ã‚·ã‚¹ãƒ†ãƒ é€šçŸ¥ã®å ´åˆã¯å¤ªæž ã‚’ã¤ã‘ã‚‹ */
  border: ${({$type:e})=>e==="system"?"2px solid #fff":"none"};

  padding: 12px 16px;
  border-radius: 8px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
  font-family: "Inter", sans-serif;
  font-size: 0.95rem;
  font-weight: ${({$type:e})=>e==="system"?"bold":"normal"};

  min-width: 260px;
  max-width: 400px;

  /* ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³æœ‰åŠ¹åŒ– */
  pointer-events: auto;
  cursor: pointer;
  user-select: none;

  /* Animation */
  animation: ${({$isExiting:e})=>e?X`
          ${pi} 0.3s ease-in forwards
        `:X`
          ${ui} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards
        `};

  &:active {
    transform: scale(0.98);
    filter: brightness(0.9);
  }
`,un=({item:e})=>{const t=O(l=>l.removeNotification),[n,r]=y.useState(!1),s=y.useRef(null);y.useEffect(()=>{if(n)return;const l=e.type==="error"||e.type==="system"?li:di,f=setTimeout(()=>{r(!0)},l);return()=>clearTimeout(f)},[e.type,n]),y.useEffect(()=>{if(!n)return;const l=setTimeout(()=>{t(e.id)},300);return()=>clearTimeout(l)},[n,e.id,t]);const o=()=>r(!0),a=l=>{s.current=l.touches[0].clientX},c=l=>{if(s.current===null)return;const f=l.changedTouches[0].clientX,d=s.current-f;Math.abs(d)>50&&r(!0),s.current=null};return i.jsxs(gi,{$type:e.type,$isExiting:n,onClick:o,onTouchStart:a,onTouchEnd:c,children:[e.type!=="system"&&i.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px",fontSize:"0.8em",opacity:.8},children:e.type.toUpperCase()}),i.jsx("div",{children:e.message})]})},mi=()=>{const e=O(r=>r.notifications),t=e.filter(r=>r.target==="alien"||r.target==="broadcast"),n=e.filter(r=>r.target==="native"||r.target==="broadcast");return i.jsxs(i.Fragment,{children:[i.jsx(fi,{children:t.map(r=>i.jsx(un,{item:r},`alien-${r.id}`))}),i.jsx(hi,{children:n.map(r=>i.jsx(un,{item:r},`native-${r.id}`))})]})},Ei={key:"info-alert",renderUI:e=>e==="ui-overlay"?i.jsx(mi,{}):null},yi=Fe`
  0% { transform: translateX(-100%); opacity: 0; }
  100% { transform: translateX(0); opacity: 1; }
`,Si=Fe`
  0% { opacity: 1; }
  100% { opacity: 0; }
`,Ii=P.div`
  position: absolute;
  left: 0;
  width: 100%;
  height: 50%;
  z-index: 150;
  pointer-events: none;
  display: flex;
  align-items: center; /* åž‚ç›´ä¸­å¤®é…ç½® */
  justify-content: center; /* æ°´å¹³ä¸­å¤®é…ç½® */

  ${({$side:e})=>e==="top"?X`
          top: 0;
          transform: rotate(180deg);
        `:X`
          bottom: 0;
        `}
`,Ti=P.div`
  width: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  background: rgba(0, 0, 0, 0.6);
  padding: 40px 0;

  /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡ */
  animation: ${({$isExiting:e})=>e?X`
          ${Si} 0.5s ease-in forwards
        `:X`
          ${yi} 0.3s ease-out forwards
        `};
`,xi=P.h2`
  font-size: 2.5rem;
  color: white;
  text-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
  margin: 0;
  padding: 10px 40px;
  background: rgba(0, 0, 0, 0.5);
  border-top: 2px solid white;
  border-bottom: 2px solid white;
  width: 100%;
  text-align: center;
  box-sizing: border-box;
`,Ci=P.div`
  font-size: 1.2rem;
  color: #ddd;
  margin-top: 10px;
  font-weight: bold;
`,pn=({side:e,message:t,subMessage:n,isExiting:r})=>i.jsx(Ii,{$side:e,children:i.jsxs(Ti,{$isExiting:r,children:[i.jsx(xi,{children:t}),n&&i.jsx(Ci,{children:n})]})}),Ai=()=>{const{isGameOver:e}=N.useGameState();N.useActivePlayer();const[t,n]=y.useState(!1),[r,s]=y.useState(!1),[o,a]=y.useState(!1),[c,l]=y.useState({message:"",subMessage:""}),f=y.useRef(null),d=y.useRef(null),u=y.useRef(null),g=y.useRef(null),p=E=>E==="alien"?"å¤–æ¥ç¨®":"åœ¨æ¥ç¨®",h=(E,S)=>{f.current&&clearTimeout(f.current),d.current&&clearTimeout(d.current),l({message:E,subMessage:S}),n(!0),s(!1),f.current=setTimeout(()=>{s(!0),d.current=setTimeout(()=>{n(!1)},500)},2e3)};return y.useEffect(()=>{if(e)return;const E=T=>{const C=T.round===J.MAXIMUM_ROUNDS?"FINAL ROUND":`ROUND ${T.round}`;a(!0),g.current&&clearTimeout(g.current),h(C,""),u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{h(`${p("alien")}ã®ã‚¿ãƒ¼ãƒ³`,"Turn Start"),g.current=setTimeout(()=>{a(!1)},2500)},2800)},S=T=>{u.current&&clearTimeout(u.current),a(!0),g.current&&clearTimeout(g.current),h(`${p(T.playerId)}ã®ã‚¿ãƒ¼ãƒ³`,"Turn Action"),g.current=setTimeout(()=>{a(!1)},2500)};return U.on("ROUND_START",E),U.on("PLAYER_ACTION_START",S),()=>{U.off("ROUND_START",E),U.off("PLAYER_ACTION_START",S),f.current&&clearTimeout(f.current),d.current&&clearTimeout(d.current),u.current&&clearTimeout(u.current),g.current&&clearTimeout(g.current)}},[e]),!t&&!o?null:i.jsxs(i.Fragment,{children:[t&&i.jsxs(i.Fragment,{children:[i.jsx(pn,{side:"top",message:c.message,subMessage:c.subMessage,isExiting:r}),i.jsx(pn,{side:"bottom",message:c.message,subMessage:c.subMessage,isExiting:r})]}),i.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:140,pointerEvents:"auto"}})]})},Ri={key:"info-banner",renderUI:e=>e==="ui-overlay"?i.jsx(Ai,{}):null},vi=P.div`
  position: absolute;
  left: 0;
  width: 100%;
  height: 50%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  background-color: rgba(0, 0, 0, 0.9);
  color: white;
  z-index: 100;
  pointer-events: auto;
  border-bottom: 1px solid #333;
  border-top: 2px solid;
  ${({$side:e})=>e==="top"?"top: 0; transform: rotate(180deg);":"bottom: 0;"}
`,Oi=P.h1`
  font-size: 3rem;
  background: linear-gradient(180deg, #36d63eff, #162716ff);
  margin-bottom: 1rem;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 2px 10px rgba(76, 175, 80, 0.3);
  text-align: center;
  white-space: pre-wrap;
`,bi=P.h2`
  margin-bottom: 5rem;
  margin-top: 0;
  font-size: 2.5rem;
  color: #aaa;
`,fn=({side:e,onStart:t,isReady:n})=>i.jsxs(vi,{$side:e,children:[i.jsx(Oi,{children:"ã€Žä¾µç·‘ã€"}),i.jsx(bi,{children:"~å¤–æ¥ç¨®vsåœ¨æ¥ç¨®é™£å–ã‚Šã‚²ãƒ¼ãƒ ~"}),i.jsx("div",{children:i.jsx(Mt,{onClick:t,disabled:n,style:{padding:"15px 35px",fontSize:"1.5rem",backgroundColor:n?"#555":"#2E7D32",border:n?"1px solid #777":"1px solid #4CAF50",cursor:n?"default":"pointer"},children:n?"å¾…æ©Ÿä¸­...":"ã‚²ãƒ¼ãƒ é–‹å§‹"})})]}),wi=Fe`
  from { opacity: 0; }
  to { opacity: 1; }
`,_i=P.div`
  position: absolute;
  left: 0;
  width: 100%;
  height: 50%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  background-color: rgba(0, 0, 0, 0.9);
  color: white;
  z-index: 200;
  pointer-events: auto;
  border-top: 4px solid ${({$resultColor:e})=>e};
  animation: ${wi} 0.5s ease-out forwards;

  ${({$side:e})=>e==="top"?"top: 0; transform: rotate(180deg);":"bottom: 0;"}
`,Pi=P.h1`
  font-size: 3rem;
  color: ${({$color:e})=>e};
  margin-bottom: 10px;
  text-shadow: 0 0 15px ${({$color:e})=>e}80;
`,Ni=P.div`
  display: flex;
  flex-direction: column;
  gap: 10px;
  background: rgba(255, 255, 255, 0.1);
  padding: 15px 30px;
  border-radius: 8px;
  margin-bottom: 20px;
  min-width: 200px;
`,hn=P.div`
  display: flex;
  justify-content: space-between;
  font-size: 1.2rem;

  &.total {
    border-top: 1px solid rgba(255, 255, 255, 0.3);
    margin-top: 5px;
    padding-top: 5px;
    font-weight: bold;
  }
`,gn=({side:e,playerId:t,onRestart:n,isReady:r})=>{const{winningPlayerId:s,alienScore:o,nativeScore:a}=N.useGameState(),c=s===t,l=s===null,f=c?"YOU WIN!":l?"DRAW":"YOU LOSE...",d=c?"#4CAF50":l?"#FFC107":"#F44336";return i.jsxs(_i,{$side:e,$resultColor:d,children:[i.jsx(Pi,{$color:d,children:f}),i.jsxs(Ni,{children:[i.jsxs(hn,{children:[i.jsx("span",{style:{color:"#E91E63"},children:"Alien"}),i.jsx("span",{children:o})]}),i.jsxs(hn,{children:[i.jsx("span",{style:{color:"#4CAF50"},children:"Native"}),i.jsx("span",{children:a})]})]}),i.jsx("div",{children:i.jsx(Mt,{onClick:n,disabled:r,style:{padding:"15px 35px",fontSize:"1.5rem",backgroundColor:r?"#555":"#2E7D32",border:r?"1px solid #777":"1px solid #4CAF50",cursor:r?"default":"pointer"},children:r?"å¾…æ©Ÿä¸­...":"ã‚¿ã‚¤ãƒˆãƒ«ã«æˆ»ã‚‹"})})]})},Di=()=>{const{isGameOver:e}=N.useGameState(),t=O(d=>d.reset),[n,r]=y.useState(!1),[s,o]=y.useState({native:!1,alien:!1}),a=d=>{o(u=>{const g={...u,[d]:!0};return g.native&&g.alien&&setTimeout(()=>{c()},500),g})},c=()=>{r(!0),o({native:!1,alien:!1}),U.emit("ROUND_START",{round:1})},l=d=>{o(u=>{const g={...u,[d]:!0};return g.native&&g.alien&&setTimeout(()=>{f()},500),g})},f=()=>{$.system.reset(),t(),r(!1),o({native:!1,alien:!1})};return n?e?i.jsxs(i.Fragment,{children:[i.jsx(gn,{side:"top",playerId:"native",onRestart:()=>l("native"),isReady:s.native}),i.jsx(gn,{side:"bottom",playerId:"alien",onRestart:()=>l("alien"),isReady:s.alien})]}):null:i.jsxs(i.Fragment,{children:[i.jsx(fn,{side:"top",onStart:()=>a("native"),isReady:s.native}),i.jsx(fn,{side:"bottom",onStart:()=>a("alien"),isReady:s.alien})]})},Li={key:"info-scene",renderUI:e=>e==="ui-overlay"?i.jsx(Di,{}):null},mn=[Ss,zs,Zs,Hs,Us,ci,Ri,Li,Ei],ji=()=>{y.useEffect(()=>{Zr();const t=r=>{r.preventDefault()};window.addEventListener("contextmenu",t);const n=[];return mn.forEach(r=>{if(r.init){const s=r.init();typeof s=="function"&&n.push(s)}}),()=>{window.removeEventListener("contextmenu",t),n.forEach(r=>r())}},[]);const e=t=>i.jsx(i.Fragment,{children:mn.map(n=>i.jsx(de.Fragment,{children:n.renderUI(t)},n.key))});return i.jsx(jr,{uiOverlay:e("ui-overlay"),children:e("main-3d")})},Fi=()=>i.jsx("style",{children:`
    body, html {
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      background-color: #000;
      font-family: 'MPLUS1p-Regular', sans-serif;
      -webkit-user-select: none;
      user-select: none;
      -webkit-touch-callout: none;

      /* âœ¨ è¿½åŠ : ãƒ–ãƒ©ã‚¦ã‚¶ã«ã‚ˆã‚‹è‡ªå‹•ã®ã‚ºãƒ¼ãƒ ã‚„ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãªã©ã®ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ã‚’ç„¡åŠ¹åŒ– */
      touch-action: none;
    }
    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
  `});yr.createRoot(document.getElementById("root")).render(i.jsxs(de.StrictMode,{children:[i.jsx(Fi,{}),i.jsx(ji,{})]}));
